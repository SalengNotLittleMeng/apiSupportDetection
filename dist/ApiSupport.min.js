!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.ApiSupport=t():e.ApiSupport=t()}(this,(()=>(()=>{var e=[(e,t,r)=>{e.exports=r(1)},(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>c});var n=r(2),o=r(7),i=r(55),a=r(57),s=r(60);class c{constructor(e){this.$options=(0,n.mergeOptions)(e),this.flowLimitController(this)&&((0,o.initRequest)(this),(0,a.initPlugin)(this),(0,i.initInfo)(this),this.$options.immediate&&this.run())}run(){const{filter:e,timeout:t}=this.$options;Promise.race([(0,s.collectApiSupportInfo)(this),new Promise((e=>{setTimeout((()=>{e()}),t)}))]).then((()=>{let t=null;t="function"==typeof e?e(this.$info.getFinInfo()):this.$info.getFinInfo(),this.requestMessage(t)}))}flowLimitController(e){const{limit:t}=e.$options;return Math.random()<=t}}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{mergeOptions:()=>s});var n=r(3),o=r(4),i=r(6);const a=new Set(["js","css","html"]);function s(e){return function(e){const{api:t=null,plugins:r}=e;t||(0,i.handlerError)(i.NEED_API);"string"==typeof t||(n=t,"object"==typeof n&&null!==n||Array.isArray(n))||(0,i.handlerError)(i.API_NEED_ARRAY_OR_OBJECT);var n;e.type&&a.has(e.type)&&(0,i.handlerError)(i.NEED_VERIFY_TYPE)}(e),function(e){const{api:t,plugins:r}=e;"string"==typeof t&&(e.api=[{name:t}]);"object"!=typeof t||Array.isArray(t)||(e.api=[t]);r||(e.plugins=[]);Array.isArray(r)||(e.plugins=[r]);e.plugins=(0,o.useInnerPlugins)(e.plugins,e.api),e.api.forEach((e=>{e.type||(e.type="js")}))}(e),c(n.defaultOptions,e)}function c(e,...t){if(!t.length)return e;const r=t.shift();if(u(e)&&u(r))for(const t in r)u(r[t])?(e[t]||Object.assign(e,{[t]:{}}),c(e[t],r[t])):Object.assign(e,{[t]:r[t]});return c(e,...t)}function u(e){return e&&"object"==typeof e&&!Array.isArray(e)}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{defaultOptions:()=>n});const n={api:[],request:null,plugins:[],filter:function(e){return e},owlOptions:{project:"",pageUrl:"",devMode:!1,autoCatch:{pv:!1,page:!1,ajax:!1,resource:!1,js:!1},metric:{combo:!1}},raptorKey:"sdk_data",immediate:!0,timeout:3e3,limit:1}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{useInnerPlugins:()=>i});var n=r(5);const o=new Map([["serviceWorker",n.default]]);function i(e,t){return e.map((e=>{if("string"==typeof e)return a(e,t);if("object"==typeof e&&null!==typeof e&&e.innerPlugin){const{params:r={},name:n=""}=e;return a(n,t,r)}return e}))}function a(e,t,r={}){if(!o.has(e))return;t.find((t=>t.name==e))||t.push({name:e});return new(o.get(e))(r)}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>a});const n="service_client_sdk",o=new Set(["eventType","type"]),i={hitCache:!1,hitPreload:!1,error:null,errorCode:0,supportServiceWorker:!0};class a{constructor(e={}){this.name="serviceWorker",this.type="js",this.test=s,this.filter=c,this.async=!0}}function s(){const e=this;return new Promise((t=>{navigator.serviceWorker?navigator.serviceWorker.register("./sw.js").then((r=>{!function(e,t){navigator.serviceWorker.addEventListener("message",(function(r){const{data:i}=r;i.eventType==n&&(o.forEach((e=>{i[e]&&delete i[e]})),t.setExtraData(i),e(!0))}))}(t,e),function(e,t){window.addEventListener("unload",(()=>{t.setExtraData({error:"未收到传输消息",errorCode:1001}),e(!1)}))}(t,e)})).catch((e=>{console.log(e),t(!1)})):t(!1)}))}function c(e){return e?(e.supportServiceWorker=e.support,delete e.support,{...i,...e}):{...i,error:"timeout",errorCode:1002,supportServiceWorker:!0,isInit:!1,hitPreload:!1,hitCache:!1}}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{API_NEED_ARRAY_OR_OBJECT:()=>o,NEED_API:()=>n,NEED_VERIFY_TYPE:()=>a,PLUGINS_NEED_ARRAY_OR_OBJECT:()=>i,PLUGIN_NEED_NAME:()=>s,handlerError:()=>c});const n="api parameter required",o="The api parameter should be an array or object type",i="The plugins parameter should be an array or object type",a="The parameter 'type' should be 'js','css' or 'html'",s="The plugin requires a parameter name";function c(e){throw Error(e)}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{initRequest:()=>a,requestMessage:()=>i});var n=r(8),o=r(9);async function i(e){try{if(!navigator.onLine)return void n.default.addHistroyData({...e,errorCode:3e3});await function(e){const t=(0,o.getOwlMetricInst)();t.setExtraData(JSON.stringify(e)),t.setMetric(t.raptorKey,1),t.report()}(e)}catch(e){console.log(e)}}function a(e){e.$options&&e.$options.request&&"function"==typeof e.$options.request?e.requestMessage=e.$options.request:((0,o.initOwlMetricInst)(e),e.requestMessage=i),n.default.useHistroyData(e.requestMessage)}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>n});const n=new class{constructor(){this.key="API_SUPPORT_SDK_STORAGE"}addHistroyData(e){let t=localStorage.getItem(this.key);t?(t=JSON.parse(t),t instanceof Array&&t.push(e)):t=[],localStorage.setItem(this.key,JSON.stringify(t))}useHistroyData(e){let t=localStorage.getItem(this.key);t&&(t=JSON.parse(t),t instanceof Array?setTimeout((()=>{t.forEach((t=>{e(t)})),localStorage.removeItem(this.key)})):localStorage.removeItem(this.key))}}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{getOwlMetricInst:()=>s,initOwlMetricInst:()=>a});var n=r(10),o=r.n(n);let i=null;function a(e){if(i)return i;const{$options:t}=e;return window.Owl.start(t.owlOptions),i=o().MetricManager(),i.raptorKey=t.raptorKey,i}function s(){return i||a()}},(e,t,r)=>{"use strict";var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();var i=r(11),a=r(18),s=r(35),c=r(40),u=r(42),f=r(43),l=r(44),p=r(45),g=r(20),h=r(47),d=r(13),v=r(15),m=r(12),y=r(33),w=r(21),S=r(29),b=r(16).version,E=r(28),T=r(49),M=r(50),O=r(51),k=function(){function e(t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var n=new i(t);this.errManager=new a(n),this.pageManager=new s(n,this.errManager),this.resManager=new c(n,this.errManager),this.metricManager=new u(n),this.pvManager=new f(n),this.logManager=new l(n),this.cfgManager=n,this.cfgManager.setExtension(p.getExt()),r&&r.noFilter||h(this.cfgManager)}return o(e,[{key:"config",value:function(e){this.cfgManager.set(e)}},{key:"getConfig",value:function(e){return this.cfgManager.get(e)}},{key:"debug",value:function(){this.cfgManager.set({devMode:!0}),d.setDebug()}},{key:"addError",value:function(e,t){var r=t&&t.combo||this.getConfig("error").combo?"push":"report";this.errManager[r](e,t)}},{key:"sendErrors",value:function(){this.errManager.report()}},{key:"addPoint",value:function(e){if(e&&void 0!==e.position){var t=void 0;if(void 0!==e.duration)t=e;else{var r=g.getPerfTiming(),n=r&&r.navigationStart;"number"==typeof n&&(t={position:e.position,duration:(e.timeStamp||+new Date)-n})}t&&(this.pageManager.setUserReady(),this.pageManager.push(t))}}},{key:"sendPoints",value:function(){this.pageManager.report(!0)}},{key:"addApi",value:function(e){var t=["undefined","number"];if(!e||t.indexOf(n(e.networkCode))<0||t.indexOf(n(e.statusCode))<0)return d.log("参数对象属性类型错误");var r=void 0!==e.networkCode?e.networkCode:"",o=void 0!==e.statusCode?e.statusCode:"",i={type:"api",connectType:e.connectType||"",resourceUrl:e.name,statusCode:r+"|"+o,responsetime:e.responseTime&&e.responseTime.toString()||"0"};e.content&&(i.firstCategory=S.AJAX,i.secondCategory=e.secondCategory||e.name,i.logContent=e.content),this.resManager.pushApi(i)}},{key:"reportApi",value:function(){this.addApi.apply(this,arguments)}},{key:"sendApis",value:function(){this.resManager.report()}},{key:"addLog",value:function(){y._log.apply(y,arguments)}},{key:"createLog",value:function(){return new l(this.cfgManager)}},{key:"resetPv",value:function(e){var t=this;e=e||{};var r=this.cfgManager,n=r.get("pageUrl"),o=e.pageUrl||g.getPageUrl(),i=e.project||r.get("project"),a={project:i,pageUrl:o,pageId:e.pageId||"owl-"+v()};r.set(a),e.delay?(this.resetPvTimer&&clearTimeout(this.resetPvTimer),this.resetPvTimer=setTimeout((function(){t.pvManager.report(a),y._log("[Navigation]:"+JSON.stringify({project:i,from:n,to:o}),"owl","info",["navi"])}),200)):(this.pvManager.report(a),y._log("[Navigation]:"+JSON.stringify({project:i,from:n,to:o}),"owl","info",["navi"]))}},{key:"reportPv",value:function(){this.pvManager.report()}},{key:"newMetricInst",value:function(){return new u(this.cfgManager)}},{key:"updateFilter",value:function(e,t){t?this.cfgManager.addFilter(e,t):this.cfgManager.removeFilter(e)}},{key:"removeFilter",value:function(e){this.cfgManager.removeFilter(e)}},{key:"wrap",value:function(e,t,r){if("function"!=typeof e)return e;try{if(e.__owl_wrapped__)return e;if(e.__owl_wrapper__)return e.__owl_wrapper__}catch(t){return e}var n=function(){try{return e.apply(t,arguments)}catch(e){x.addError(e,r)}};for(var o in e)e.prototype.hasOwnProperty(o)&&(n[o]=e[o]);return n.prototype=e.prototype,e.__owl_wrapper__=n,n.__owl_wrapper__=!0,n}},{key:"setDimension",value:function(e){this.cfgManager.setExtension(e)}},{key:"getDimension",value:function(e){this.cfgManager.getExtension(e)}},{key:"reportFST",value:function(){var e=this.cfgManager.get("page");e.sensoryIndex||e.manualReportFST||(this.cfgManager.set({page:{manualReportFST:!0}}),this.pageManager.manualReportFST())}},{key:"createInstance",value:function(e){var t=null;try{window.Owl&&window.Owl.OWL&&e&&e.project&&(void 0===e.devMode&&(e.devMode=window.Owl.cfgManager.get("devMode")),t=new window.Owl.OWL(e))}catch(e){g.reportSysError(e)}return t}},{key:"getResTimingInfo",value:function(e){if(!window.performance||"function"!=typeof window.performance.getEntriesByName)return null;try{if("string"==typeof e){var t=window.performance.getEntriesByName(e,"resource");if(t instanceof Array&&t.length&&t[0]){var r=parseInt(Math.round(t[0].duration));return isNaN(r)?null:{name:e,duration:r}}}else if(e instanceof Array){for(var n=[],o=0;o<e.length;o++)if("string"==typeof e[o]){var i=this.getResTimingInfo(e[o]);n.push(i||null)}else n.push(null);return n}}catch(e){g.reportSysError(e)}return null}},{key:"SDKMetrics",value:function(e){try{if(!e||!e.project)return;var t=this.createInstance({project:e.project,devMode:e.devMode,metric:{combo:!1}});if(!t||!t.metricManager)return;var r=t.metricManager,o={project:e.userProject||"",version:e.version||""};"object"===n(e.tags)&&(o=m(o,e.tags)),r.setTags(o),r.setExtraData(e.version||"");var i=Math.random(),a=m({auto:!0,sample:.01},e.pv);a.auto&&i<a.sample&&r.setMetric("sdkPV",1);var s=m({auto:!0,sample:.01},e.resource);if(e.url&&s.auto&&i<s.sample){var c=void 0,u=this.getResTimingInfo(e.url);if(u instanceof Array){for(var f=0;f<u.length;f++)if(u[f]&&void 0!==u[f].duration){c=u[f].duration;break}}else u&&void 0!==u.duration&&(c=u.duration);isNaN(c)||r.setMetric("sdkCDNTiming",c)}r.report()}catch(e){g.reportSysError(e)}}}]),e}(),x=new k({},{noFilter:!0});x.OWL=k,x.__version__="1.9.5",x.errorModel=E,x.MetricManager=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:x.cfgManager;return new u(e)},x.start=function(e){if(!(g.checkIsSpider()||window.Owl&&window.Owl.isStarted)){this.isStarted=!0;var t=this.cfgManager;(e=e||{}).pageUrl=e.pageUrl||g.getPageUrl(),t.set(e);var n=t.get("project"),o=t.get("logan");o&&o.enable&&y.ready({LoganAPI:o.Logan,project:n,pageUrl:t.get("pageUrl"),loganConfig:o.config,version:o.version||"2.1.2"}),h(t),T(this.pageManager),M(this.errManager),O(this.resManager);var i=t.get("autoCatch")||{};i.pv&&this.reportPv();var a=t.get("SPA")||{};if(a.autoPV||a.getFST){g.hackHistoryStateFuncs();var s=this;w.on("validStateChange",(function(e){try{if(a.autoPV&&s.resetPv({delay:!0}),a.getFST&&"complete"==document.readyState){var t=e.path,r=s.prevRoutePath;s.prevRoutePath=t,s.pageManager.getRouteFst(t,r)}}catch(e){g.reportSysWarn(e)}}))}var c=function(e){try{if(e&&e.length){var t=e[0];if(!t||"string"!=typeof t)return d.warn("Api名称不是有效字符串");if("start"==t)return d.warn("start方法不可重复执行");if("function"!=typeof x[t])return d.warn(t+"不是有效的Api");try{var r=e.slice(1);return x[t].apply(x,r)}catch(e){d.warn(t+" Api执行报错"),d.warn(e),g.reportSysWarn(e)}}else d.warn("Api调用未传入有效参数")}catch(e){g.reportSysWarn(e)}},u=window.owl&&window.owl.q;if(u&&u.length)for(var f=0;f<u.length;f++)c(u[f]);window.owl=function(){var e=[].slice.call(arguments);return c(e)};var l="_Owl_";if(window[l]){window[l].isReady=!0;var p=window[l],v=p.preTasks,m=p.dataSet;v&&v.length&&(v.forEach((function(e){x[e.api]&&x[e.api].apply(x,e.data)})),window[l].preTasks=[]),setTimeout((function(){m&&m.length&&m.forEach((function(e){try{if("jsError"===e.type&&i.js){var t=e.data&&"unhandledrejection"===e.data[0].type?"parsePromiseUnhandled":"parseWindowError";x.errManager[t].apply(x.errManager,e.data)}else"resError"===e.type&&i.resource?x.resManager.handleResourceLoadError.apply(x.resManager,e.data):"resTime"===e.type?x.resManager.handleResourceTiming.apply(x.resManager,e.data):"pageTime"===e.type&&x.pageManager.parsePageTime.apply(x.pageManager,e.data)}catch(e){}})),window[l].dataSet=[]}),0)}this.errManager.checkCache(),r(54)("owl_sdk",x);var S=g.getProtocol()+"//www.dpfile.com/app/owl/static/owl_";this.SDKMetrics({project:"owl",userProject:n,version:b,url:[S+"latest.js",S+b+".js"]})}},window.Owl instanceof k||(window.Owl=x);var C=window.owl&&window.owl.q;if(C&&C.length){var I=C[0];I&&"start"===I[0]&&x.start(I[1])}e.exports=x},(e,t,r)=>{"use strict";var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();var i=r(12),a=r(13),s=r(14),c=r(15),u=r(16).version,f=r(17),l=["region","operator","network","container","os","unionId"],p=f+"//catfront.dianping.com",g=f+"//catfront.51ping.com",h=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._config={devMode:!1,project:"",pageUrl:"",webVersion:"",autoCatch:{page:!0,ajax:!0,fetch:!1,resource:!0,js:!0,console:!1,pv:!0},page:{sample:.5,auto:!0,sensoryIndex:!0,disableSensoryImageIndex:!0,interactToStopObserver:!0,noCheckOuterMutaCount:!1,fstPerfSample:.5,fstPerfAnalysis:!1,logSlowView:!1,delay:0,logFirstScreen:!1,ignoreIframe:!0,mainResourceNumber:5,timeThreshold:5},SPA:{autoPV:!1,getFST:!1},resource:{sample:.1,sampleApi:.1,combo:!0,delay:1e3,catchAbort:!0,catchTimeout:!1,enableStatusCheck:!1,ignoreMTSIForbidRequest:!0},resourceReg:/(.51ping|.dianping|.dpfile|.meituan|.sankuai|.kuxun|.maoyan|.neixin|.mobike|.dper.com)/,enableLogTrace:!1,ajax:{invalid:!0,flag:!1,duration:2e3,autoBusinessCode:!1,parseResponse:function(e){return e&&"object"===(void 0===e?"undefined":n(e))?{code:e.code||e.status}:{}}},invalid:{ajax:!0},image:{flag:!1,duration:5e3,fileSize:100,filter:!1},error:{sample:1,delay:1e3,combo:!1,maxSize:10240,maxNum:100,maxTime:6e4,formatUnhandledRejection:!1},useSendBeacon:!1,disableCache:!0,noScriptError:!0,metric:{sample:.5,combo:!0,delay:1500},logan:{enable:!1},ignoreList:{js:["Illegal invocation"],ajax:["https?://report.meituan.com/","https?://logan.sankuai.com/"],resource:["https?://hls.dianping.com/","https?://frep.meituan.net/"]},disabledFilters:[],pageId:"owl-"+c()},this.baseQuery={v:1,sdk:u},this.apiPaths={log:"/api/log",error:"/api/log",page:"/api/speed",resource:"/batch",metric:"/api/metric",pv:"/api/pv",fstInfo:"/raptorapi/fstSpeed",fstLog:"/raptorapi/fstLog"},this.userConfig={},this.config={},this.extensions={},this.filters=[],this.url=p,t?this.set(t):this.config=this._config}return o(e,[{key:"get",value:function(e){return e?this.config[e]:this.config}},{key:"set",value:function(e){for(var t in e)if(e.hasOwnProperty(t)){var r=e[t];"devMode"===t&&(this.setApiDomain(r),r&&a.setDebug()),"webVersion"===t&&r&&(this.baseQuery.webVersion=r),"ext"===t&&this.setExtension(r),"resource"===t&&r&&(r.sample=void 0);try{"object"!==(void 0===r?"undefined":n(r))||r instanceof RegExp||r instanceof Array?this.userConfig[t]="resourceReg"!==t?r:new RegExp(r):"pageUrl"!==t&&(this.userConfig[t]=i(this.userConfig[t],r))}catch(e){a.ignore(e)}}this.update()}},{key:"update",value:function(){for(var e in this.config=this._config,this.userConfig){var t=this.userConfig[e];"object"!=(void 0===t?"undefined":n(t))||t instanceof RegExp||t instanceof Array?this.config[e]=t:this.config[e]=i(this.config[e],this.userConfig[e])}}},{key:"setApiDomain",value:function(e){this.url=e?g:p}},{key:"getExtension",value:function(e){return e?this.extensions[e]:this.extensions}},{key:"setExtension",value:function(e){if(e)for(var t in e)if(e.hasOwnProperty(t)){var r=e[t];"latlng"==t?(this.extensions.region=r,this.baseQuery.useLatlng=!0):l.indexOf(t)>-1&&(this.extensions[t]=r)}}},{key:"addFilter",value:function(e,t){if(e&&t instanceof Function&&this.config.disabledFilters&&-1===this.config.disabledFilters.indexOf(e)){for(var r=-1,n=0;n<this.filters.length;n++){var o=this.filters[n];if(o.key===e){r=n,o.fn=t;break}}-1===r&&this.filters.push({key:e,fn:t})}}},{key:"removeFilter",value:function(e){for(var t=0;t<this.filters.length;t++){if(this.filters[t].key===e)return void this.filters.splice(t,1)}}},{key:"getApiPath",value:function(e){var t=this.apiPaths[e];return s.stringify(this.url+t,this.baseQuery)}}]),e}();e.exports=h},e=>{"use strict";e.exports=function(e,t){var r={};if(e)for(var n in e)r[n]=e[n];if(t)for(var o in t)t.hasOwnProperty(o)&&void 0!==t[o]&&(r[o]=t[o]);return r}},e=>{"use strict";e.exports={devMode:!1,setDebug:function(){this.devMode=!0},ignore:function(){window.Owl&&window.Owl.debugLog&&(window.console.log("【OWL日志:】"),window.console.log&&window.console.log.apply(window.console,arguments))},log:function(e){this.devMode&&console.log("[Owl]",e)},warn:function(e){this.devMode&&console.warn("[Owl]",e)},logScreen:function(){window.Owl&&window.Owl.cfgManager.get("page").logFirstScreen&&console.log.apply(console,arguments)}}},e=>{"use strict";e.exports={stringify:function(e,t){if(!t)return e;var r=[];for(var n in t)t.hasOwnProperty(n)&&r.push(n+"="+t[n]);return~e.indexOf("?")?e+"&"+r.join("&"):e+"?"+r.join("&")},replaceParam:function(e,t,r){if(!e||!t)return e;try{var n=new RegExp("(&"+t+"=)([^\\?&]+)(&?)");if(n.test(e))e=r?e.replace(n,"$1"+r+"$3"):e.replace(n,"$3");else if(r){var o={};o[t]=r,e=this.stringify(e,o)}}catch(e){}return e}}},e=>{"use strict";function t(){return(65536*(1+Math.random())|0).toString(16).substring(1)}e.exports=function(){return t()+t()+"-"+t()+"-"+t()+"-"+t()+"-"+t()+"-"+Date.now()}},(e,t)=>{"use strict";t.version="1.11.1"},e=>{"use strict";var t=window.location.protocol?window.location.protocol:"http:";t=new RegExp("http").test(t)?t:"http:",e.exports=t},(e,t,r)=>{"use strict";var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();var i=r(19),a=r(12),s=r(28),c=r(31),u=r(29),f=r(30),l=r(13),p=r(20),g=r(14),h=r(33),d=r(16).version,v="error",m=function(e){return"c="+encodeURIComponent(JSON.stringify(e))},y=function(e){if(e&&e.data)return i({url:e.url,type:"POST",header:{"Content-Type":"application/x-www-form-urlencoded"},data:m(e.data),success:e.success,fail:e.fail,xhrRewritten:e.xhrRewritten})},w=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.cfgManager=t,this.cache=[],this.cacheSending={},this.comboTimeout=0,this.timeLimit=Date.now(),this.errorCount=0,this.isTimeLimit=!1,this.detectLeave()}return o(e,[{key:"parseWindowError",value:function(e,t,r,n,o){try{o&&o.stack?("Invalid_Error"!==(o=this._processError(o)).sec_category&&(o.rowNum=o.rowNum||r,o.colNum=o.colNum||n,o.resourceUrl=o.resourceUrl||t),this._push(o)):"string"==typeof e&&this._push({category:u.SCRIPT,sec_category:e,resourceUrl:t,rowNum:r,colNum:n})}catch(e){this.reportSystemError(e)}}},{key:"parsePromiseUnhandled",value:function(e){if(e&&"unhandledrejection"===e.type)try{var t=e.reason;if(t){var r="unhandledrejection",n="";if(t instanceof Error){var o=t.message||t.name||"";o&&this.cfgManager.get(v).formatUnhandledRejection&&(r="[unhandledrejection] "+o),n=t.stack||t.toString()||""}else n=t;this._push({category:u.SCRIPT,sec_category:r,content:n})}}catch(e){this.reportSystemError(e)}}},{key:"parseConsoleError",value:function(){try{var e=Array.prototype.slice.call(arguments);if(!e||!e.length)return;for(var t=[],r=0;r<e.length;r++){var n=e[r];if(n){var o="";o="string"==typeof n?n:n instanceof window.Error?n.stack||n.message||"":n instanceof window.ErrorEvent?n.error&&(n.error.stack||n.error.message)||n.message||"":JSON.stringify(n),t.push(o)}}t&&t.length&&this._push({category:u.SCRIPT,sec_category:"consoleError",content:t.join(" ")})}catch(e){this.reportSystemError(e)}}},{key:"detectLeave",value:function(){var e=this;try{var t=window.onbeforeunload;window.onbeforeunload=function(){var r=e.cfgManager.get("disableCache")||window.Owl&&window.Owl.cfgManager.get("disableCache"),n=e.cfgManager.get("useSendBeacon")&&window.navigator&&window.navigator.sendBeacon;if(!r||n){var o=e.addCacheExtension(),i=e.cacheSending;if(i&&Object.keys(i).length)for(var a in i)try{if(i.hasOwnProperty(a)&&i[a]){var s=i[a],u=s.xhr,f=s.cache;u.abort(),f instanceof Array&&f.length&&(o=o.concat(f))}}catch(e){l.ignore(e)}if(o&&o.length)if(n){var p=g.stringify(e.cfgManager.getApiPath(v),{pageId:e.cfgManager.get("pageId"),beacon:1});window.navigator.sendBeacon(p,m(o))}else r||c.add(o,e.cfgManager.get("webVersion"))}t&&t.call()}}catch(e){l.ignore(e)}}},{key:"checkCache",value:function(){var e=this;setTimeout((function(){var t=c.get();if(c.clearAll(),"object"===(void 0===t?"undefined":n(t))&&Object.keys(t).length){var r=e.cfgManager,o=r.get("webVersion")||"",i=r.getApiPath(v);for(var a in t)try{var s=t[a];if(s instanceof Array&&s.length){var u="no-version"===a?"":a,f=u!==o?g.replaceParam(i,"webVersion",u):i;y({url:f,data:s,xhrRewritten:!!r.get("autoCatch").ajax})}}catch(t){e.reportSystemError(t)}}}),4e3)}},{key:"reportSystemError",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(e)try{this.cache.push(new s({project:"owl",pageUrl:"version_"+d,category:t.category||u.SCRIPT,level:t.level||f.ERROR,realUrl:p.getHref(),sec_category:e.message||e.name||"parseError",content:e.stack?JSON.stringify(e.stack):e.toString&&e.toString()||""})),this.send(!0)}catch(e){}}},{key:"reportSystemWarn",value:function(e,t){e&&((t=t||{}).level=f.WARN,this.reportSystemError(e,t))}},{key:"_processError",value:function(e){var t=function(e){var t=e.message||e.name||"Invalid_Error",r=e instanceof Error?e.toString():JSON.stringify(e);return{category:u.SCRIPT,sec_category:t,content:r}};try{return function(e){if(e.stack){var r=e.stack.match("https?://[^\n]+");r=r?r[0]:"";var n=/https?:\/\/(\S)+\.js/,o=n.test(r)?r.match(n)[0]:"",i=r.match(":(\\d+):(\\d+)");return i||(i=[0,0,0]),{category:u.SCRIPT,sec_category:e.message||e.name||"",content:e.stack,resourceUrl:o,rowNum:i[1],colNum:i[2]}}return t(e)}(e)}catch(r){return this.reportSystemError(r),t(e)}}},{key:"_push",value:function(e,t){e=this.parse(e),this.push(new s(e),t)}},{key:"_pushResource",value:function(){Math.random()>this.cfgManager.get("resource").sample||this._push.apply(this,arguments)}},{key:"parse",value:function(e){return e.project||(e.project=this.cfgManager.get("project")),e.pageUrl||(e.pageUrl=this.cfgManager.get("pageUrl")||"default"),e.unionId||(e.unionId=this.cfgManager.getExtension("unionId")),e.realUrl=p.getHref(),e}},{key:"push",value:function(e,t){var r=this.cfgManager,o=r.get(v);if(e&&!(Math.random()>o.sample)&&(e instanceof s||(e instanceof Error?e=this._processError(e):"string"==typeof e?e={sec_category:e}:"object"===(void 0===e?"undefined":n(e))&&(e={sec_category:e.name||"",content:e.msg||""}),e=this.parse(e),e=new s(e)),!(e.content&&e.content.length>=o.maxSize))){e.update(t);try{var i=[],a=JSON.stringify(e.toLoganJson(),(function(e,t){if("object"===(void 0===t?"undefined":n(t))&&null!==t){if(i.indexOf(t)>=0)return;i.push(t)}return t}));h._log("[Error]:"+a,"owl",e.level,[e.category])}catch(e){this.reportSystemError(e)}var c=!0;if(r.get("noScriptError")&&0===e.sec_category.indexOf("Script error"))return!1;var u=r.filters;if(u&&u.length)for(var f=0;f<u.length;f++){if(!u[f].fn(e))return!1}var l=r.get("ignoreList").js;if(l&&l.length)for(var p=0;p<l.length;p++)if(0===e.sec_category.indexOf(l[p])){c=!1;break}if(c){try{if(window&&window.dispatchEvent&&e&&e.getEventInfo){var g=e.getEventInfo({pageId:r.get("pageId")||""}),d=void 0;if("function"==typeof window.CustomEvent)d=new CustomEvent("owlErrDetected",{detail:g});else if(document&&"function"==typeof document.createEvent){var m=document.createEvent("CustomEvent");"function"==typeof m.initCustomEvent&&(d=m.initCustomEvent("owlErrDetected",!1,!1,g))}d&&window.dispatchEvent(d)}}catch(e){this.reportSystemError(e)}this.isExist(e)||(e=this._handleError(e))&&(this.cache.push(e),this.send())}}}},{key:"isExist",value:function(e){for(var t=0;t<this.cache.length;t++){var r=this.cache[t];if(r instanceof s||(r=new s(r)),r.isEqual(e))return!0}return!1}},{key:"_handleError",value:function(e){try{var t=this.cfgManager.get("onErrorPush");if(t instanceof Function&&(e=t(e)),e instanceof s||void 0===e)return e;l.ignore("onErrorPush 方法的返回值仅能为ErrorModel实例或undefined")}catch(t){return l.ignore("onErrorPush 方法处理有误",t),e}}},{key:"report",value:function(){this.push.apply(this,arguments),this.send(!0)}},{key:"send",value:function(e){var t=this,r=this.cfgManager,n=r.get(v),o=this.comboTimeout,i=n.maxNum||100,a=n.maxTime||6e4,s=Date.now()-this.timeLimit;this.isTimeLimit||(this.timeLimit=Date.now()),this.isTimeLimit=!0;var u=function(){if(t.cache.length){clearTimeout(o),o=0;try{if(t.errorCount+=t.cache.length,s<=a){if(t.errorCount>=i)return}else t.isTimeLimit=!1,t.errorCount=0}catch(e){l.ignore(e)}var e=t.addCacheExtension(),n=+new Date,u=y({url:r.getApiPath(v)+"&pageId="+r.get("pageId"),data:e,success:function(){t.cacheSending[n]=void 0},fail:function(){try{if(!(r.get("disableCache")||window.Owl&&window.Owl.cfgManager.get("disableCache"))){var e=t.cacheSending[n];e&&e.cache&&e.cache.length&&c.add(e.cache,r.get("webVersion"))}t.cacheSending[n]=void 0}catch(e){t.cacheSending[n]=void 0,l.ignore(e)}},xhrRewritten:!!r.get("autoCatch").ajax});t.cacheSending[n]={xhr:u,cache:e},t.cache=[]}},f=n.delay;e?u():o||-1===f||(o=setTimeout(u,f))}},{key:"addCacheExtension",value:function(){var e=this.cache,t=[];if(!e||!e.length)return t;for(var r=this.cfgManager.getExtension(),o=0;o<e.length;o++){var i=e[o];r&&"object"===(void 0===r?"undefined":n(r))&&(i=a(i.toJson(),r)),t.push(i)}return t}}]),e}();e.exports=w},(e,t,r)=>{"use strict";var n=r(20),o=function(){};e.exports=function(e){if(e){var t=n.getUserAgent(),r=-1!==n.getAppName().indexOf("Microsoft Internet Explorer")&&(-1!==t.indexOf("MSIE 8.0")||-1!==t.indexOf("MSIE 9.0"))&&window.XDomainRequest,i=void 0;(i=r?new XDomainRequest:new XMLHttpRequest).open(e.type||"GET",e.url,!0),i.success=e.success||o,i.fail=e.fail||o;var a=function(t){t&&/catfront.(dianping|51ping).com/.test(e.url)&&(200===t.currentTarget.status?i.success&&i.success():i.fail&&i.fail())};if(!1===e.xhrRewritten&&!r)if("addEventListener"in i)i.addEventListener("load",a),i.addEventListener("error",a),i.addEventListener("abort",a);else{var s=i.onreadystatechange;i.onreadystatechange=function(e){4===this.readyState&&a(e),s&&s.apply(this,arguments)}}if("POST"===e.type){if(e.header&&!r)for(var c in e.header)e.header.hasOwnProperty(c)&&i.setRequestHeader(c,e.header[c]);i.send(e.data)}else i.send();return i}}},(e,t,r)=>{"use strict";var n=r(21),o=["baiduspider","googlebot","bingbot","yammybot","360spider","haosouspider","youdaobot","sogou news spider","yisouspider","mtdp-infosec","mtdp-searchspider","yandexbot","yandexmobilebot"],i=r(22),a=r(23),s=a&&a.__esModule?a:{default:a};e.exports={hackHistoryStateFuncs:function(){if(!this.historyStateHacked){var e=window.addEventListener||window.attachEvent,t=this;e("hashchange",(function(e){try{var r=e&&e.newURL||"",o=e&&e.oldURL||"",i=t.parseRoutePath(r),a=t.parseRoutePath(o);i&&a&&i!==a&&n.trigger("validStateChange",{path:i})}catch(e){t.reportSysError(e)}}));try{this.hackStateFunc("pushState"),this.hackStateFunc("replaceState")}catch(e){this.reportSysWarn(e)}this.historyStateHacked=!0}},hackStateFunc:function(e){var t=window.history[e];if("function"==typeof t){var r=this;window.history[e]=function(e,o,i){var a=location.href,s=t.apply(window.history,[].slice.call(arguments)),c=location.href;if(!i||"string"!=typeof i||c===a)return s;try{var u=r.parseRoutePath(a),f=r.parseRoutePath(c);f&&u&&f!==u&&n.trigger("validStateChange",{path:f})}catch(e){r.reportSysError(e)}return s}}},parseRoutePath:function(e){if(e&&"string"==typeof e){var t=e.replace(/^(https?:)?(\/\/[^\/]*)?/,""),r=t.match(/\?.*$/)&&t.match(/\?.*$/)[0]||"",n=r.match(/\#.*$/)&&r.match(/\#.*$/)[0]||"";return t.replace(/\?.*$/,"")+n}return""},getHref:function(){return location&&location.href||""},getProtocol:function(){return location&&location.protocol||"https:"},getOrigin:function(){return location.origin||location.protocol+"//"+location.hostname+(location.port?":"+location.port:"")},getPageUrl:function(){return this.getHref().replace(/\?.*(?=(\#))/,"").replace(/\?.*/,"")},getPerfTiming:function(){return window.performance&&window.performance.timing},getConnectionType:function(){var e=window.navigator&&window.navigator.connection;return e&&(e.effectiveType||e.type)||""},reportSysError:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=window.Owl&&window.Owl.errManager;r&&"function"==typeof r.reportSystemError&&r.reportSystemError(e,t)},reportSysWarn:function(e,t){(t=t||{}).level="warn",this.reportSysError(e,t)},getUserAgent:function(){return window.navigator&&window.navigator.userAgent||""},getAppName:function(){return window.navigator.appName},checkIsSpider:function(){try{for(var e=this.getUserAgent().toLowerCase(),t=0;t<o.length;t++)if(e.indexOf(o[t])>-1)return!0}catch(e){this.reportSysError(e)}return!1},getFullUrl:function(e){return 0===e.indexOf("//")?e=this.getProtocol()+e:0===e.indexOf("/")&&(e=this.getOrigin()+e),e},checkSameOrigin:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return t=t||this.getOrigin(),!(!e||!t)&&0===(e=this.getFullUrl(e)).indexOf(t)},traceid:function(){try{var e=s.default.v1().replace(/-/g,""),t=e.slice(0,16),r=e.slice(16),n=Array(16).fill(0).map((function(e,n){return parseInt(t[15-n],16)^parseInt(r[15-n],16)})).map((function(e){return e.toString(16)})).join("");return(0,i.signedHexToDec)(n)}catch(e){return this.reportSysError(e),""}},getXPath:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3;try{var r=e.id?"#"+e.id:"",n="string"==typeof e.className&&e.className?"."+e.className.split(" ").join("."):"",o=("string"==typeof e.nodeName?e.nodeName.toLowerCase():"")+r+n;return e.parentNode&&e.parentNode.nodeName&&t-1>0?this.getXPath(e.parentNode,t-1)+" > "+o:o}catch(e){return""}}}},e=>{"use strict";e.exports={on:function(e,t){e&&t&&(this._events_=this._events_||{},this._events_[e]=this._events_[e]||[],this._events_[e].push(t))},trigger:function(e){var t=this._events_;if(e&&t&&t[e])for(var r=t[e],n=[].slice.call(arguments,1),o=0;o<r.length;o++)r[o].apply(this,n)}}},(e,t)=>{"use strict";var r;!function(){function n(e){for(;"0"===e[0]&&e.length>1;)e=e.slice(1);return e}function o(e,t){if(!e)return 0;var r=parseInt(e,t);if(isNaN(r))throw new Error("parse char '"+e+"' to number("+t+") failed");return r}function i(e,t,r){for(var n,i="",a=e.length,s=t.length,c=0,u=0;u<a||u<s;)n=o(e[a-++u],r)+o(t[s-u],r)+c,c=Math.floor(n/r),i=(n%r).toString(r)+i;for(;c>0;)i=(c%r).toString(r)+i,c=Math.floor(c/r);return i}function a(e,t,r){if(function(e,t,r){if(e.length>t.length)return 1;if(e.length<t.length)return-1;for(var n=0;n<e.length;){var i=o(e[n],r),a=o(t[n],r);if(i>a)return 1;if(i<a)return-1;n++}return 0}(e,t,r)<0)return a(t,e,r);for(var i,s="",c=e.length,u=t.length,f=0,l=0;l<c;)(i=o(e[c-++l],r)-o(t[u-l],r)+f)<0&&(f=-1,i+=r),s=i.toString(r)+s;return n(s)}function s(e,t,r){for(var n,i="",a=0,s=e.length;--s>=0;)n=o(e[s],r)*t+a,a=Math.floor(n/r),i=(n%r).toString(r)+i;for(;a>0;)i=(a%r).toString(r)+i,a=Math.floor(a/r);return i}function c(e,t,r,a){e=n(e),t=t||10,r=r||16;for(var c="0",u="1",f=0;f++<e.length;)c=i(c,s(u,o(e[e.length-f],t),r),r),u=s(u,t,r);return a?function(e,t){for(;e.length<t;)e="0"+e;return e}(c,a):c}c.signedHexToDec=function(e){var t=e.length>15&&o(e[0],16)>=8,r=c(t?a("10000000000000000",e,16):e,16,10);return t?"-"+r:r},c.signedDecToHex=function(e,t){var r="-"===e[0],n=c(r?e.slice(1):e,10,16,t);return r?a("10000000000000000",n,16):n},e.exports?e.exports=c:void 0===(r=function(){return c}.apply(t,[]))||(e.exports=r)}()},(e,t,r)=>{var n=r(24),o=r(27),i=o;i.v1=n,i.v4=o,e.exports=i},(e,t,r)=>{var n,o,i=r(25),a=r(26),s=0,c=0;e.exports=function(e,t,r){var u=t&&r||0,f=t||[],l=(e=e||{}).node||n,p=void 0!==e.clockseq?e.clockseq:o;if(null==l||null==p){var g=i();null==l&&(l=n=[1|g[0],g[1],g[2],g[3],g[4],g[5]]),null==p&&(p=o=16383&(g[6]<<8|g[7]))}var h=void 0!==e.msecs?e.msecs:(new Date).getTime(),d=void 0!==e.nsecs?e.nsecs:c+1,v=h-s+(d-c)/1e4;if(v<0&&void 0===e.clockseq&&(p=p+1&16383),(v<0||h>s)&&void 0===e.nsecs&&(d=0),d>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");s=h,c=d,o=p;var m=(1e4*(268435455&(h+=122192928e5))+d)%4294967296;f[u++]=m>>>24&255,f[u++]=m>>>16&255,f[u++]=m>>>8&255,f[u++]=255&m;var y=h/4294967296*1e4&268435455;f[u++]=y>>>8&255,f[u++]=255&y,f[u++]=y>>>24&15|16,f[u++]=y>>>16&255,f[u++]=p>>>8|128,f[u++]=255&p;for(var w=0;w<6;++w)f[u+w]=l[w];return t||a(f)}},e=>{var t="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(t){var r=new Uint8Array(16);e.exports=function(){return t(r),r}}else{var n=new Array(16);e.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),n[t]=e>>>((3&t)<<3)&255;return n}}},e=>{for(var t=[],r=0;r<256;++r)t[r]=(r+256).toString(16).substr(1);e.exports=function(e,r){var n=r||0,o=t;return[o[e[n++]],o[e[n++]],o[e[n++]],o[e[n++]],"-",o[e[n++]],o[e[n++]],"-",o[e[n++]],o[e[n++]],"-",o[e[n++]],o[e[n++]],"-",o[e[n++]],o[e[n++]],o[e[n++]],o[e[n++]],o[e[n++]],o[e[n++]]].join("")}},(e,t,r)=>{var n=r(25),o=r(26);e.exports=function(e,t,r){var i=t&&r||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var a=(e=e||{}).random||(e.rng||n)();if(a[6]=15&a[6]|64,a[8]=63&a[8]|128,t)for(var s=0;s<16;++s)t[i+s]=a[s];return t||o(a)}},(e,t,r)=>{"use strict";var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();var o=r(20),i=r(12),a=r(29),s=r(30),c=["project","pageUrl","realUrl","resourceUrl","category","sec_category","level","unionId","timestamp","content","traceid"],u=["rowNum","colNum","tags"].concat(c),f=["project","pageUrl","category","sec_category","level","unionId"],l=function(){function e(t){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t){for(var r in t)t.hasOwnProperty(r)&&(this[r]=t[r]);this.parse(t)}}return n(e,[{key:"parse",value:function(){this.category=this.category||a.SCRIPT,this.level=this.level||s.ERROR,this.timestamp=this.timestamp||+new Date,this.sec_category=this.sec_category||"default"}},{key:"isEqual",value:function(e){return this.sec_category===e.sec_category&&this.resourceUrl===e.resourceUrl&&this.colNum===e.colNum&&this.rowNum===e.rowNum&&this.content===e.content}},{key:"update",value:function(e){if(e)for(var t in e)void 0!==e[t]&&u.indexOf(t)>-1&&(this[t]=e[t]);return this}},{key:"updateTags",value:function(e){return this.tags=i(this.tags||{},e),this}},{key:"toJson",value:function(){var e=this,t={};c.map((function(r){void 0!==e[r]&&(t[r]=e[r])}));var r=this.rowNum,n=this.colNum;return t.category===a.SCRIPT&&r&&n&&(t.dynamicMetric={rowNum:r,colNum:n}),this.tags&&(t.dynamicMetric=i(t.dynamicMetric||{},this.tags)),t}},{key:"toLoganJson",value:function(){var e=this,t={};u.map((function(r){void 0!==e[r]&&(t[r]=e[r])}));try{var r=t.content||"";"string"!=typeof r&&(r=JSON.stringify(r)),t.content=r.substr&&r.substr(0,200)||""}catch(e){t.content="",o.reportSysError(e)}return t}},{key:"getEventInfo",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r={};for(var n in f.map((function(t){void 0!==e[t]&&(r[t]=e[t])})),t)t.hasOwnProperty(n)&&(r[n]=t[n]);return r}}]),e}();l.LEVEL=s,l.CATEGORY=a,e.exports=l},e=>{"use strict";e.exports={SCRIPT:"jsError",AJAX:"ajaxError",RESOURCE:"resourceError"}},e=>{"use strict";e.exports={ERROR:"error",INFO:"info",WARN:"warn",DEBUG:"debug"}},(e,t,r)=>{"use strict";var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=r(32),i=r(13),a="owl_cache",s="owl_cache_v2";e.exports={isSupport:o(),get:function(){if(this.isSupport){var e={};try{var t=localStorage.getItem(s);if(t){var r=JSON.parse(t);"object"===(void 0===r?"undefined":n(r))&&Object.keys(r).length&&(e=r)}}catch(e){this.clear(s),i.ignore(e)}try{var o=localStorage.getItem(a);if(o){var c=JSON.parse(o);c instanceof Array&&(e["no-version"]=c.concat(e["no-version"]||[]))}}catch(e){this.clear(a),i.ignore(e)}return e}},add:function(e,t){if(this.isSupport)try{if(e instanceof Array){t=t||"no-version";var r=this.get();r[t]instanceof Array?r[t]=e.concat(r[t]):r[t]=e,localStorage.setItem(s,JSON.stringify(r))}}catch(e){i.ignore(e)}},clear:function(e){if(this.isSupport)try{e=e||a,localStorage.removeItem(e)}catch(e){i.ignore(e)}},clearAll:function(){if(this.isSupport)try{localStorage.removeItem(a),localStorage.removeItem(s)}catch(e){}},clearItem:function(e){if(this.isSupport)try{var t=this.get();"object"===(void 0===t?"undefined":n(t))&&t.hasOwnProperty(e)&&(delete t[e],Object.keys(t).length?localStorage.setItem(s,JSON.stringify(t)):localStorage.removeItem(s),"no-version"===e&&localStorage.removeItem(a))}catch(e){i.ignore(e)}}}},e=>{"use strict";e.exports=function(){var e="owl_local_test";try{localStorage.setItem(e,1),localStorage.removeItem(e)}catch(e){return!1}return!0}},(e,t,r)=>{"use strict";var n=r(34).loadScript,o=void 0,i=!1;e.exports={queue:[],ready:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.LoganAPI,a=t.project,s=t.pageUrl,c=t.loganConfig,u=t.version;i=!0;var f=function(){if(o)for(c&&(o=o.config(c)),o.log("[Session]:"+JSON.stringify({project:a,pageUrl:s}),"owl","info",["session"]);e.queue.length;)o.log(e.queue.shift(),"owl")};if(r)o=r,f();else try{if(window.Logan)o=window.Logan,f();else{var l=(0===u.indexOf("1.")?"//www.dpfile.com/app/dp-logan-web/logan_":"//s3.meituan.net/v1/mss_eb9ea9cfff9840198c3ae909b17b4270/production/logan-websdk/logan_")+u+".js";n(l,(function(){o=window.Logan,f()}))}}catch(e){console.log("logan 加载失败")}},log:function(e){if(i){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).noType?"default":"owl";o?o.log(e,t):this.queue.push(e)}},_log:function(){try{o&&o.log&&o.log.apply(o,arguments)}catch(e){}}}},(e,t)=>{"use strict";var r=[];t.loadScript=function(e,t){if(~r.indexOf(e))t();else{var n=document.createElement("script");n.src=e,n.onload=function(){r.push(e),t()},document.getElementsByTagName("head")[0].appendChild(n)}}},(e,t,r)=>{"use strict";var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();var o=r(19),i=r(14),a=r(12),s=r(33),c=r(13),u=r(36),f=r(37),l=f.jsPattern,p=f.cssPattern,g=f.imgPattern,h=f.urlPattern,d=r(38),v=Number.parseInt||window.parseInt,m="page",y=function(e){var t=Math&&Math.round?Math.round(e):e;return v(t)},w=function(){function e(t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.cfgManager=t,this.errManager=r,this.points=[],this.pointsCustom=[],this.noCache="false",this.titansTags={}}return n(e,[{key:"setInitConfig",value:function(){this.initialPage=this.cfgManager.get("pageUrl"),this.initialProject=this.cfgManager.get("project")}},{key:"setUserReady",value:function(){this.cfgManager.get(m).auto||this.cfgManager.set({page:{auto:!0}})}},{key:"getUserReady",value:function(){return this.cfgManager.get(m).auto}},{key:"setReady",value:function(){this.isReady=!0}},{key:"getReady",value:function(){return this.isReady}},{key:"getPerformaceTiming",value:function(){return{perf:window.performance&&window.performance.timing,paint:window.performance&&window.performance.getEntriesByType&&window.performance.getEntriesByType("paint")}}},{key:"getMainResourceTiming",value:function(){var e=window.performance&&window.performance.getEntriesByType&&window.performance.getEntriesByType("resource"),t=this.cfgManager.get(m).isMainResource,r=[];try{if(!e)return;if("function"==typeof t){for(var n=0;n<e.length;n++){var o=e[n];t(o)&&r.push(o)}return r}for(var i=0;i<e.length;i++){var a=e[i];"link"!==a.initiatorType&&"script"!==a.initiatorType||r.push(a)}var s=this.cfgManager.get(m).mainResourceNumber;return r.length<=s?r:r.splice(0,s)}catch(e){c.ignore(e)}}},{key:"sensoryObserver",value:function(){this.firstScreenManager=new d(this.cfgManager,this),this.firstScreenManager.mutaObserver()}},{key:"getRouteFst",value:function(e,t){this.firstScreenManager&&e&&(t&&this.firstScreenManager.stopRouteMutaObserver(t),Math.random()<this.cfgManager.get(m).sample&&this.firstScreenManager.startRouteMutaObserver(e))}},{key:"reportRouteFst",value:function(e,t){var r=this,n=this.cfgManager;setTimeout((function(){var s=[];s[27]=e;var c=a({project:n.get("project"),pageurl:encodeURIComponent(t),speed:encodeURIComponent(s.join("|")),customspeed:"",timestamp:+new Date,noCache:r.noCache,pageId:n.get("pageId")},n.getExtension()),u=i.stringify(n.getApiPath(m),c);o({url:u,method:"GET"})}),0)}},{key:"parsePageTimeWithDefer",value:function(){var e=this;setTimeout((function(){try{e.cfgManager.get(m).sensoryIndex?e.firstScreenManager.getSensoryIndex((function(t){e.parsePageTime(t),e.parseFirstScreenPerf(t)})):e.parsePageTime()}catch(t){e.parsePageTime()}}),0)}},{key:"parsePageTime",value:function(e){var t=this.getPerformaceTiming(),r=t.perf,n=t.paint;if(!r)return this.setReady();var o=r.navigationStart,i={unloadEventStart:1,unloadEventEnd:2,redirectStart:3,redirectEnd:4,fetchStart:5,domainLookupStart:6,domainLookupEnd:7,connectStart:8,connectEnd:9,requestStart:10,responseStart:11,responseEnd:12,domLoading:13,domInteractive:14,domContentLoadedEventStart:15,domContentLoadedEventEnd:16,domComplete:17,loadEventStart:18,loadEventEnd:19};for(var a in i){var c=r[a]||0;this.points[i[a]]=c?c-o:0}this.points[20]=r.domainLookupEnd-r.domainLookupStart,this.points[21]=r.connectEnd-r.connectStart,this.points[22]=r.responseEnd-r.requestStart;var u=0,f=0;if(n&&n.length){for(var l=0;l<n.length;l++){var p=n[l];"first-paint"===p.name?u=v(p.startTime):"first-contentful-paint"===p.name&&(f=v(p.startTime))}u&&f&&(this.points[23]=u,this.points[24]=f)}e&&(this.points[25]=e.FST&&e.FST>f?e.FST:f,this.points[26]=e.FCP||f||this.points[15]),window.Owl&&window.Owl.fstInfo&&(window.Owl.fstInfo.FST=this.points[25]);try{var g=window.titansReport;if(!g&&window.KNBTitansXSync&&"function"==typeof window.KNBTitansXSync.getTitansReport){var h=window.KNBTitansXSync.getTitansReport();g=h&&JSON.parse(h)}if(g){if(g.h5Env){var d=g.h5Env;d.timestamp&&d.timestamp.h5EnvInit&&(this.points[28]=r.loadEventStart-d.timestamp.h5EnvInit),d.timing&&(this.points[29]=d.timing.h5EnvPrepare,this.points[30]=d.timing.pagePreprocess,this.points[31]=d.timing.webviewPrepare),d.tag&&void 0!==d.tag.isWebViewInitialed&&(this.titansTags.isWebViewInitialed=d.tag.isWebViewInitialed?"true":"false")}if(g.urlPreprocess){var y=g.urlPreprocess;y.timing&&(this.points[32]=y.timing.urlPreprocess),y.tag&&void 0!==y.tag.isInterJump&&(this.titansTags.isInterJump=y.tag.isInterJump?"true":"false")}g.commonTag&&g.commonTag.titansCoreVersion&&(this.titansTags.titansCoreVersion=g.commonTag.titansCoreVersion)}}catch(e){this.errManager.reportSystemWarn(e)}for(var w=0;w<this.points.length;w++)(isNaN(this.points[w])||this.points[w]<0)&&(this.points[w]=0);var S=this.cfgManager,b={project:S.get("project"),pageUrl:S.get("pageUrl"),start:this.points[11],dcl:this.points[16],load:this.points[18],fst:this.points[25]||0};s._log("[Performance]:"+JSON.stringify(b),"owl","info",["perf"]);var E=this.getMainResourceTiming();if(E)for(var T=S.get(m).timeThreshold,M=0;M<E.length;M++){var O=E[M];void 0!==O.transferSize?0!==O.transferSize&&(this.noCache="true"):void 0!==O.duration&&O.duration>T&&(this.noCache="true")}this.setReady(),this.report()}},{key:"push",value:function(e){!e||"number"!=typeof e.position||e.position<0||e.position>31||(this.pointsCustom[e.position]=e.duration||0,this.report())}},{key:"clearTimeout",value:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(){clearTimeout(this.timeout),this.timeout=void 0}))},{key:"report",value:function(e){var t=this,r=this.cfgManager;if((!r.get("autoCatch").page||this.getReady())&&this.getUserReady()&&(this.points.length||this.pointsCustom.length)&&!(Math.random()>r.get(m).sample)){try{this.timeout?this.clearTimeout():this.pendingAjax&&"function"==typeof this.pendingAjax.abort&&this.pendingAjax.abort()}catch(e){this.errManager.reportSystemError(e)}var n=function(){if(t.clearTimeout(),t.points.length||t.pointsCustom.length){var e=t.points.length&&t.initialPage||r.get("pageUrl"),n=t.points.length&&t.initialProject||r.get("project"),s=r.getExtension(),c=a({project:n,pageurl:encodeURIComponent(e),speed:encodeURIComponent(t.points.join("|")),customspeed:encodeURIComponent(t.pointsCustom.join("|")),timestamp:+new Date,noCache:t.noCache,pageId:r.get("pageId")},s);c=a(c,t.titansTags);var u=i.stringify(r.getApiPath(m),c);t.pendingAjax=o({method:"GET",url:u,success:function(){t.points=[],t.pointsCustom=[],t.pendingAjax=void 0},xhrRewritten:!!r.get("autoCatch").ajax})}},s=r.get(m).delay||0;e?n():s>=0&&(this.timeout=setTimeout((function(){n()}),s))}}},{key:"parseFirstScreenPerf",value:function(e){var t=this,r=this.cfgManager,n=r.get(m),s=n.delay||0;setTimeout((function(){if(!0===n.fstPerfAnalysis&&e&&e.FST){var s=window.performance&&window.performance.getEntriesByType&&window.performance.getEntriesByType("resource");if(s&&s.length){var c=v(e.FST||0),u=Math.random(),f=u<n.fstPerfSample,d=c<2e3?.05:.1,m=!0===n.logSlowView&&c>1e3&&u<d;if(f){var w={picCount:0,picSize:0,jsCount:0,jsSize:0,cssCount:0,cssSize:0,ajaxCount:0},S={js:{},css:{},img:{},ajax:{}},b=void 0,E=void 0,T=void 0,M=void 0,O=void 0,k=void 0,x=void 0,C=void 0,I=void 0;try{s.filter((function(e){return e.fetchStart&&e.fetchStart<c})).forEach((function(e){var t="",r=e.name||"",n=e.initiatorType||"",o=e.transferSize||0;if(r&&n&&("img"===n||r.match(g)?(t="img",w.picCount++,w.picSize+=o):"script"===n||"link"===n&&r.match(l)?(t="js",w.jsCount++,w.jsSize+=o):"css"===n||"link"===n&&r.match(p)?(t="css",w.cssCount++,w.cssSize+=o):"xmlhttprequest"!==n&&"fetch"!==n&&"beacon"!==n||(t="ajax",w.ajaxCount++)),m&&t&&r){var i=r.match(h);if(i&&i[1]&&i[2]){var a=e.decodedBodySize||0,s=e.duration||0;b=y(e.responseEnd-e.fetchStart),E=y(e.fetchStart),T=y(e.domainLookupStart-e.fetchStart),M=y(e.domainLookupEnd-e.domainLookupStart),O=y(e.connectEnd-e.connectStart),k=y(e.connectEnd-e.secureConnectionStart),x=y(e.responseStart-e.requestStart),C=y(e.responseEnd-e.responseStart),I=o+","+b+","+E+","+M+","+O+","+k+","+x+","+C+","+T+","+(o>0||!(a>0||s<30)?0:1),S[t][i[1]]instanceof Array?S[t][i[1]].push([i[2],I]):S[t][i[1]]=[[i[2],I]]}}}));var P=i.stringify(r.getApiPath("fstInfo")),R=a({p:t.initialProject||r.get("project"),page:t.initialPage||r.get("pageUrl"),ts:Date.now(),pageId:r.get("pageId"),unionId:r.getExtension("unionId"),respTime:c},w);if(o({type:"POST",url:P,header:{"Content-Type":"application/x-www-form-urlencoded"},data:"data="+encodeURIComponent(JSON.stringify(R))}),m){var j=i.stringify(r.getApiPath("fstLog")),_={p:t.initialProject||r.get("project"),page:t.initialPage||r.get("pageUrl"),ts:Date.now(),pageId:r.get("pageId"),unionId:r.getExtension("unionId"),respTime:c,content:JSON.stringify(S)};o({type:"POST",url:j,header:{"Content-Type":"application/x-www-form-urlencoded"},data:"data="+encodeURIComponent(JSON.stringify(_))})}}catch(e){t.errManager.reportSystemError(e)}}}}}),s)}},{key:"manualReportFST",value:function(){var e=this,t=this.cfgManager.get(m);if(!t.sensoryIndex&&t.manualReportFST&&!this.firstScreenManager&&u.PerformanceNow()){this.points=[],this.pointsCustom=[],window._Owl_&&window._Owl_.pageData&&(window._Owl_.pageData=[]);var r=v(performance.now());this.sensoryObserver(),setTimeout((function(){try{t&&t.manualReportFST&&e.firstScreenManager.getSensoryIndex((function(t){e.parseAsyncFST(t,r)}))}catch(e){c.ignore(e)}}),0)}}},{key:"parseAsyncFST",value:function(e,t){if(e){var r=v(e.FST||0)-t,n=v(e.FCP||0)-t;r>0&&(this.points[25]=r,this.points[26]=n>0?n:0)}for(var o=0;o<this.points.length;o++)isNaN(this.points[o])&&(this.points[o]=0);this.setReady(),this.report()}}]),e}();e.exports=w},(e,t,r)=>{"use strict";var n=r(20);e.exports={PerformanceObserver:function(){if(window.PerformanceObserver)try{var e=/Chrome\/(\d+)/,t=n.getUserAgent();if(!e.test(t))return!0;var r=t.match(e)[1];if(parseInt(r)>59)return!0}catch(e){}},MutationObserver:function(){if(window.MutationObserver)try{var e=-1,t=n.getUserAgent();if(t.indexOf("compatible")>-1&&t.indexOf("MSIE")>-1?(new RegExp("MSIE (\\d+\\.\\d+);").test(t),e=parseFloat(RegExp.$1)):t.indexOf("Trident")>-1&&t.indexOf("rv:11.0")>-1&&(e=11),-1===e||e>11)return!0}catch(e){}},PerformanceNow:function(){return!(!window.performance||!window.performance.now||"function"!=typeof window.performance.now)},GetEntries:function(){return!(!window.performance||"function"!=typeof window.performance.getEntries)}}},e=>{"use strict";e.exports={jsPattern:/\.js$/i,cssPattern:/\.css$/i,imgPattern:/\.(png|jpg|jpeg|gif|webp|ico|bmp|tiff|svg)$/i,urlPattern:/^(https?:\/\/[^/\r\n]+)(\/[^\r\n]*)?$/}},(e,t,r)=>{"use strict";var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();var o=r(39),i=r(13),a=r(36),s=r(20),c=[],u=null,f=null,l=!1,p=!1,g=void 0,h=-1,d=void 0,v=0,m=void 0,y=3e3,w=3,S=1,b=0,E=["HTML","HEAD","META","LINK","SCRIPT","STYLE","NOSCRIPT"],T=Array.prototype.slice,M=Number.parseInt||window.parseInt,O={height:window.innerHeight||0,width:window.innerWidth||0},k=O.height,x=O.width,C="page",I=function(){function e(t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.cfgManager=t,this.pageManager=r,this.pageData=[],this.observer=null,this.disableMutaObserver=!1;var n=t.get(C),o=M(n.mutaStopTime||0);if(this.mutaStopTime=o>y?o:y,this.perfObserver=null,this.ignoreDom=n.ignoreAttr||"owl-ignore",this.imgPattern=/(\.)(png|jpg|jpeg|gif|webp|ico|bmp|tiff|svg)/i,this.noCheckOuterMutaCount=n.noCheckOuterMutaCount,this.canStartObserver=a.PerformanceNow()&&a.MutationObserver(),this.spaRoutesData={},m=n.scrollDom,window._Owl_&&(this.pageData=window._Owl_.pageData,this.observer=window._Owl_.observer,this.disableMutaObserver=window._Owl_.disableMutaObserver),this.disableMutaObserver||!document.body){l=!0,p=!0;try{this.observer&&this.observer.disconnect()}catch(e){}}}return n(e,[{key:"mutaObserver",value:function(){var e=this;if(this.canStartObserver&&!l){if(this.observer&&this.observer.disconnect)try{this.observer.disconnect(),this.observer=null,this.pageData&&this.pageData.length&&this.pageData.forEach((function(t){e.mutaCallback(t.mutations,t.startTime,!1)}))}catch(e){console.log("observer disconnect err")}var t=this.cfgManager.get(C);try{if(this.observer=new MutationObserver((function(t){var r=performance.now();e.mutaCallback(t,r,!0)})),this.observer.observe(document.body,{childList:!0,subtree:!0}),this.resetTimer(!0),!0===t.interactToStopObserver&&document&&document.addEventListener)if("complete"===document.readyState)this.interactToStopObserver();else(window.addEventListener||window.attachEvent)("load",(function(){e.interactToStopObserver()}))}catch(e){console.log("observer observe err")}d=t.disableSensoryImageIndex,(p=d||p)||this.registerPerfObserver()}}},{key:"registerPerfObserver",value:function(){var e=this,t=this.cfgManager.get("resource").disablePerformanceObserver||!1;if(a.PerformanceObserver()&&!0!==t){var r=setTimeout((function(){e.perfObserverStop()}),8e3);this.perfObserver=new window.PerformanceObserver((function(){clearTimeout(f),f=setTimeout((function(){clearTimeout(r),e.perfObserverStop()}),y)})),this.perfObserver.observe({entryTypes:["resource"]})}else p=!0}},{key:"getSensoryIndex",value:function(e){var t=this,r=0,n=setTimeout((function(){clearInterval(r),t.mutaObserverStop(),t.perfObserverStop(),e(g)}),8e3);r=setInterval((function(){l&&p&&(clearInterval(r),clearTimeout(n),g?(d||function(e,t){var r=o.getImageTimingsInFirstScreen(e,t,m);if(g&&r.length){var n=Math.round(r[0]);g.FST=Math.max(g.FST,n),i.logScreen("首屏图片时间: ",n),i.logScreen("最终首屏时间: ",g.FST),window.Owl&&window.Owl.fstInfo&&(window.Owl.fstInfo.imgFST=n)}}(t.ignoreDom,t.imgPattern),e(g)):e())}),500)}},{key:"resetTimer",value:function(e){var t=this;u&&clearTimeout(u),e&&(u=setTimeout((function(){i.logScreen(t.mutaStopTime+"ms时间内没有监听到新的DOM变化, 停止DOM变化监听"),t.mutaObserverStop()}),this.mutaStopTime))}},{key:"mutaCallback",value:function(e,t,r){var n=this;r&&this.resetTimer(!0),t=t||performance.now(),setTimeout((function(){l||(i.logScreen("DOM原始变更:",t,e),e.filter((function(e){var t=(e.target.nodeName||"").toUpperCase();return"childList"===e.type&&t&&E.indexOf(t)<0&&e.addedNodes&&e.addedNodes.length})).forEach((function(e){if(!l){var r=T.call(e.addedNodes,0).filter((function(e){var t=(e.nodeName||"").toUpperCase();return 1===e.nodeType&&t&&E.indexOf(t)<0&&"IFRAME"!==t&&!1!==e.isConnected&&!P(e,n.ignoreDom)}));if(r&&r.length&&r[0]){c.push({nodes:r,startTime:t});var o,a,u=r[0];h<0&&(o=u,a=t,performance&&performance.getEntriesByType&&performance.getEntriesByType("paint")&&document&&document.body&&""!==document.body.innerText?h=0:(o&&(3===o.nodeType||""!==o.innerText)||document.querySelector&&document.querySelector("img"))&&(h=M(a||0)));try{if(!n.noCheckOuterMutaCount){var f=u.getBoundingClientRect&&u.getBoundingClientRect();f&&f.width&&f.height&&f.top>=k&&(i.logScreen("检测到首屏外节点次数: "+ ++v+"次, 节点内容为:",r),v>=15&&(i.logScreen("检测到首屏外mutation达到 15 次, 停止DOM变化监听"),n.mutaObserverStop()))}}catch(e){s.reportSysWarn(e)}document&&document.querySelectorAll&&r.forEach((function(e){n.addEventToStopObserver(e)}))}}})))}),0)}},{key:"mutaObserverStop",value:function(){if(this.observer&&this.observer.disconnect)try{this.observer.disconnect(),this.observer=null;var e=this.cfgManager.get(C);!function(e){if(l)return;!function(e){var t=[];e&&(i.logScreen("筛选后的有效DOM变更:",c),c.forEach((function(e){var r=e.nodes,n=e.startTime,o=[];if(r.forEach((function(e){var t=e.style||{},r=t.visibility,n=t.display;if("hidden"!==r&&"none"!==n){var i=e.getBoundingClientRect&&e.getBoundingClientRect();R(i)&&o.push({node:e,rect:i})}})),o.length){var a=j(o);a&&(t.push({score:a,startTime:n,validNodes:o}),i.logScreen("有效的首屏内新增节点:",o,"新增节点的权重和发生时间:",a,n))}})));l=!0,c=[];var r=A(t);g={FST:r,FCP:h||0},i.logScreen("最终DOM首屏时间的计算结果为: ",r)}(e)}(e.sensoryIndex||e.manualReportFST),this.resetTimer(!1)}catch(e){console.log("observer disconnect err")}}},{key:"perfObserverStop",value:function(){try{this.perfObserver&&this.perfObserver.disconnect&&(this.perfObserver.disconnect(),this.perfObserver=null),p=!0}catch(e){console.log("perfObserver disconnect err")}}},{key:"addEventToStopObserver",value:function(e){var t=this;T.call(e.querySelectorAll("[interactive]"),0).forEach((function(e){var r=e.getAttribute("interactive")||"click";e.addEventListener(r,(function n(){t.mutaObserverStop(),e.removeEventListener(r,n)}))}))}},{key:"interactToStopObserver",value:function(){var e=this;if(!l){var t=function(){l||(i.logScreen("onload后响应到用户交互事件, 停止DOM变化监听"),e.mutaObserverStop()),r()},r=function(){document.removeEventListener("click",t),document.removeEventListener("wheel",t),document.removeEventListener("touchmove",t)};document.addEventListener("click",t),document.addEventListener("wheel",t),document.addEventListener("touchmove",t)}}},{key:"startRouteMutaObserver",value:function(e){var t=this;if(l&&this.canStartObserver&&document.body){var r=performance.now(),n={start:r,pageUrl:"",observer:null,mutaRecords:[],domTimer:null,domDone:!1,outCount:0,fst:0,interactCallback:null};this.spaRoutesData[e]=n,i.logScreen("["+e+"] "+r+" 时刻开始首屏计算");try{n.observer=new MutationObserver((function(r){t.routeMutaCallback(e,r)})),n.observer.observe(document.body,{childList:!0,subtree:!0}),this.resetRouteTimer(e,!0),setTimeout((function(){t.interactToStopRouteObserver(e)}),0)}catch(e){}}}},{key:"stopRouteMutaObserver",value:function(e){var t=this.spaRoutesData[e];t&&!t.domDone&&(t.domDone=!0,this.removeRouteInteractListener(e),this.resetRouteTimer(e,!1),t.observer.disconnect(),t.observer=null)}},{key:"resetRouteTimer",value:function(e,t){var r=this,n=this.spaRoutesData[e];n&&(n.domTimer&&clearTimeout(n.domTimer),n.domTimer=t?setTimeout((function(){i.logScreen("["+e+"] "+r.mutaStopTime+"ms内无新的DOM变化, 停止监听"),r.routeMutaStop(e)}),this.mutaStopTime):null)}},{key:"routeMutaCallback",value:function(e,t){var r=this,n=this.spaRoutesData[e];if(n&&!n.domDone){var o=performance.now();this.resetRouteTimer(e,!0),i.logScreen("["+e+"] DOM变化原始内容: ",o,t),t.filter((function(e){var t=(e.target.nodeName||"").toUpperCase();return"childList"===e.type&&t&&E.indexOf(t)<0&&e.addedNodes&&e.addedNodes.length})).forEach((function(t){if(n&&!n.domDone){var a=T.call(t.addedNodes,0).filter((function(e){var t=(e.nodeName||"").toUpperCase();return 1===e.nodeType&&t&&E.indexOf(t)<0&&"IFRAME"!=t&&!1!==e.isConnected&&!P(e,r.ignoreDom)}));if(a&&a.length&&a[0]){n.mutaRecords.push({nodes:a,startTime:o});try{var s=a[0].getBoundingClientRect();s&&s.width&&s.height&&s.top>=k&&(i.logScreen("["+e+"] 检测到首屏外mutation "+ ++n.outCount+"次: ",a),n.outCount>=15&&(i.logScreen("["+e+"] 检测到首屏外mutation达到 15次, 停止监听"),r.routeMutaStop(e)))}catch(e){}}}}))}}},{key:"routeMutaStop",value:function(e){try{var t=this.spaRoutesData[e];if(!t||t.domDone)return;t.domDone=!0,t.observer&&t.observer.disconnect(),t.observer=null,this.removeRouteInteractListener(e),this.resetRouteTimer(e,!1);var r=[];i.logScreen("["+e+"] 筛选后的有效DOM变化: ",t.mutaRecords),t.mutaRecords.forEach((function(t){var n=t.nodes,o=t.startTime,a=[];if(n.forEach((function(e){var t=e.style||{},r=t.visibility,n=t.display;if("hidden"!=r&&"none"!=n){var o=e.getBoundingClientRect&&e.getBoundingClientRect();R(o)&&a.push({node:e,rect:o})}})),a.length){var s=j(a);s&&(r.push({score:s,startTime:o,validNodes:a}),i.logScreen("["+e+"] 有效的首屏新增节点, 权重及时刻: ",a,s,o))}})),t.mutaRecords=[];var n=A(r,e),o=M(n-t.start);i.logScreen("["+e+"] DOM首屏时间的计算结果为: "+o),o>0&&(t.fst=o,t.pageUrl=this.cfgManager.get("pageUrl"),this.pageManager.reportRouteFst(o,t.pageUrl))}catch(e){}}},{key:"removeRouteInteractListener",value:function(e){var t=this.spaRoutesData[e];t&&t.interactCallback&&(document.removeEventListener("click",t.interactCallback),document.removeEventListener("wheel",t.interactCallback),document.removeEventListener("touchmove",t.interactCallback))}},{key:"interactToStopRouteObserver",value:function(e){var t=this,r=this.spaRoutesData[e];r&&!r.domDone&&(r.interactCallback=function(){i.logScreen("["+e+"] 响应到用户交互事件, 停止监听"),t.routeMutaStop(e)},document.addEventListener("click",r.interactCallback),document.addEventListener("wheel",r.interactCallback),document.addEventListener("touchmove",r.interactCallback))}}]),e}();function P(e,t){var r=!1;return t&&(r=!(!e.closest||!e.closest("["+t+"]"))||e.hasAttribute&&e.hasAttribute(t)),r&&i.logScreen("自定义忽略元素: ",e),r}function R(e){var t=e||{},r=t.width,n=t.height,o=t.top,i=t.right,a=t.bottom,s=t.left;return r>0&&n>0&&a>0&&o<k&&i>0&&s<x}function j(e){return e.reduce((function(e,t){return e+_(t,0)}),0)}function _(e,t){var r=e.node,n=e.rect,o=r.style||{},i=o.visibility,a=o.display;if("hidden"===i||"none"===a)return 0;if(3===r.nodeType){if(r.textContent){var s=r.textContent.charCodeAt(0);if(10!==s&&13!==s)return t+S}return 0}if(r.childNodes&&r.childNodes.length){var c=T.call(r.childNodes,0).reduce((function(e,r){return e+_({node:r},t+b)}),0);if(c>0)return c+S}var u=n||{width:r.clientWidth,height:r.clientHeight},f=u.width,l=u.height;return f>0&&l>0?t+S:0}function A(e,t){if(!e||!e.length)return 0;var r=e.reduce((function(e,t){var r=e[e.length-1];return r&&t.startTime-r.startTime<1?r.score+=t.score:e.push({score:t.score,startTime:t.startTime,nodes:t.validNodes}),e}),[]);i.logScreen("合并后的首屏新增节点权重记录:",r);var n=r.reduce((function(e,t){return!e||t.score>Math.min(e.score,w)?t:e}),null),o=M(n&&n.startTime||0);return!t&&window.Owl&&n&&(window.Owl.fstInfo={domFST:o,decisiveNode:n.nodes&&n.nodes[0]?n.nodes[0].node:""}),o}e.exports=I},(e,t,r)=>{"use strict";var n=r(13);function o(e){return e&&"data:image"===e.slice(0,10)}function i(e,t){if("IMG"===e.nodeName.toUpperCase())return e.getAttribute("data-srcset")||e.getAttribute("src");var r=window.getComputedStyle(e);return function(e,t){var r=void 0,n=e.match(/url\(.*?\)/g);if(n&&n.length){var i=n[n.length-1].replace(/^url\([\'\"]?/,"").replace(/[\'\"]?\)$/,"");t.test(i)&&!o(i)&&(r=i)}return r}(r.getPropertyValue("background-image")||r.getPropertyValue("background"),t)}function a(e,t){if(!e)return!1;var r=e.getBoundingClientRect(),n=r.top,o=r.left,i=r.right,a=r.bottom;if(!n&&!a)return!1;return(t?document.getElementById(t).scrollTop:window.scrollY||window.pageYOffset)+n<window.innerHeight&&i>0&&o<window.innerWidth}e.exports={getImageTimingsInFirstScreen:function(e,t,r){if(!window.performance||!window.performance.getEntriesByType)return[];var s=[];try{var c=window.performance.getEntriesByType("resource").filter((function(e){return"img"===e.initiatorType||"css"===e.initiatorType})).map((function(e){return{name:e.name.split(":")[1]||e.name,responseEnd:e.responseEnd,connectEnd:e.connectEnd,duration:e.duration}})),u=function(e,t,r){var n,s,c=[];try{for(var u=document.createNodeIterator(document.body,NodeFilter.SHOW_ELEMENT,(function(t){if(t&&t.getAttribute&&!t.hasAttribute(""+e))return NodeFilter.FILTER_ACCEPT}),!1),f=u.nextNode();f;){var l=i(f,t);l?(a(f,r)&&!o(l)&&c.push((n=l,s=void 0,(s=document.createElement("a")).href=n,s.href)),f=u.nextNode()):f=u.nextNode()}}catch(e){console.log("getDomImgs err")}return c}(e,t,r).join("###");return s=c.filter((function(e){return-1!==u.indexOf(e.name)})).map((function(e){var t=e.responseEnd||e.connectEnd+e.duration;return{name:e.name,time:t}})).sort((function(e,t){return t.time-e.time})),n.logScreen("首屏内图片的加载时间",s),s.map((function(e){return e.time}))}catch(e){s=[]}return s},isInFirstScreen:a}},(e,t,r)=>{"use strict";var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();var o=r(19),i=r(41),a=r(29),s=r(37),c=s.jsPattern,u=s.cssPattern,f=s.imgPattern,l=r(20),p=r(21),g=r(13),h=r(33),d=r(17),v=r(36),m=Number.parseInt||window.parseInt,y="resource",w=function(e){var t=e.split("//");if(t&&t.length>1)return t[0]+"//"+t[1].split("/")[0]+"/images"},S=function(){function e(t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.cfgManager=t,this.errManager=r,this.cache=[],this.entryCache=[],this.comboTimeout=0,this.isSupportGetEntries=v.GetEntries()}return n(e,[{key:"parseAjax",value:function(e){try{if(!e||!e.currentTarget||isNaN(e.duration))return;var t=e.type,r=e.duration,n=e.total,o=e.currentTarget,i=o.status,s=l.getFullUrl(o.responseURL||o.url);if(!this.checkUrlValid(s))return;if(this.checkMTSIForbid(o))return;var c=this.cfgManager,u=c.get("resourceReg"),f=c.get("devMode")||u instanceof RegExp&&u.test(s),p=c.get("ajax"),g=c.get(y),d=r.toString(),v=o.traceid||"",m={project:c.get("project"),url:s,method:o.method||"",duration:d,traceid:v,timestamp:+new Date};if(f){if(!p.flag||r<p.duration){var w=void 0,S=void 0,b=void 0,E="";if(g.enableStatusCheck?(S=i||("load"===t?200:500),(w=("load"===t||"readystatechange"===t)&&(S>=200&&S<300||304===S))||(E="load"===t?"":"from: xhr "+t+".",E+=o.statusText?S+" "+o.statusText:"")):(S=(w="load"===t||"readystatechange"===t&&200===i)?200:500,E=w?"":"from: xhr "+t),w&&p.autoBusinessCode&&"function"==typeof o.getResponseHeader&&"function"==typeof p.parseResponse)try{var T=o.getResponseHeader("Content-Type");if(!T||!/(text)|(json)/.test(T))return;var M=o.responseType,O=void 0;M&&"text"!==M?"json"===M&&(O=o.response):O=o.responseText;try{O=O&&"string"==typeof O?JSON.parse(O):O}catch(e){}b=p.parseResponse(O).code}catch(e){l.reportSysError(e)}this.pushApi({type:"ajax",resourceUrl:s,connectType:this.getConnectTypeByUrl(s),responsetime:d,responsebyte:n&&n.toString()?n.toString():"0",statusCode:S+"|"+(void 0===b?"":b),firstCategory:w?"":a.AJAX,logContent:E,traceid:v}),m.code=S;var k="info",x="ajax";w||(m.error={type:"default",content:E},k="error",x="ajaxError"),h._log("[Ajax]:"+JSON.stringify(m),"owl",k,[x])}else if(Math.random()<g.sampleApi){var C="ajax请求时间超过设定 "+s;this.errManager.push({name:"TIMEOUT_AJAX",msg:C},{category:a.AJAX}),m.error={type:"timeout",content:C},h._log("[Ajax]:"+JSON.stringify(m),"owl","error",["ajaxError"])}}else c.get("invalid").ajax&&p.invalid&&Math.random()<g.sample&&(this.errManager.push({name:"INVALID_AJAX",msg:s},{category:a.AJAX}),m.error={type:"invalidUrl",content:s},h._log("[Ajax]:"+JSON.stringify(m),"owl","error",["ajaxError"]))}catch(e){l.reportSysError(e)}}},{key:"parseFetch",value:function(e){try{var t=e.url,r=e.duration,n=e.isSuccess;if(!t||isNaN(r)||void 0===n)return;if(t=l.getFullUrl(t),!this.checkUrlValid(t))return;var o=this.cfgManager,i=o.get("ajax"),s=o.get("resourceReg");if(!(o.get("devMode")||s instanceof RegExp&&s.test(t)))return;if(o.get(y).ignoreMTSIForbidRequest&&e.xForbidReason&&403===e.statusCode)return;h.log("[Fetch]:"+JSON.stringify(e),"owl","error",["ajaxError"]);var c=void 0,u=void 0,f=void 0,p=void 0,g=e.response;if(n){var d=!!e.ok,v=d?200:404;if(c=e.statusCode||v,u=d?"":a.AJAX,f=d?"":c+" "+(e.statusText||""),i.autoBusinessCode)try{g=g&&"string"==typeof g?JSON.parse(g):g,p=i.parseResponse(g).code}catch(e){}}else c="500",u=a.AJAX,f=e.errMsg||e.errName||"";this.pushApi({type:"fetch",resourceUrl:t,connectType:this.getConnectTypeByUrl(t),responsetime:r.toString()||"0",responsebyte:"0",statusCode:c+"|"+(void 0===p?"":p),firstCategory:u,logContent:f,traceid:e.traceid})}catch(e){l.reportSysError(e)}}},{key:"checkUrlValid",value:function(e){try{for(var t=this.cfgManager.get("ignoreList").ajax||[],r=0;r<t.length;r++){if(new RegExp(t[r]).test(e))return!1}}catch(e){return l.reportSysError(e),!1}return!0}},{key:"checkMTSIForbid",value:function(e){if(!e||!this.cfgManager.get(y).ignoreMTSIForbidRequest)return!1;try{if(403===e.status&&"function"==typeof e.getAllResponseHeaders){var t=e.getAllResponseHeaders();if(t&&t.indexOf("x-forbid-reason")>-1)return!0}}catch(e){l.reportSysError(e)}return!1}},{key:"parseType",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return e&&t?("img"===e||t.match(f)?e="image":"script"===e||"link"===e&&t.match(c)?e="js":("css"===e||"link"===e&&t.match(u))&&(e="css"),e):""}},{key:"filterResource",value:function(e){try{for(var t=this.cfgManager.get("ignoreList").resource,r=0;r<t.length;r++){if(new RegExp(t[r]).test(e))return!1}return!0}catch(e){return l.reportSysError(e),!1}}},{key:"parsePerformanceEntries",value:function(e){if((e=this.filterEntries(e))&&e.length){for(var t=this.cfgManager,r=t.get("devMode"),n=t.get("resourceReg"),o=t.get("image"),i=this.entryCache,s=0;s<e.length;s++){var c=e[s],u=c.name;if(this.filterResource(u)&&(r||n instanceof RegExp&&n.test(u))){i.push(u);var f=!1,l=this.parseType(c.initiatorType,u),p="image"===l,g=m(c.duration||0)||0;if(o.flag&&p){var h=o.filter;if(!h||"function"==typeof h&&!h(u)){var d=void 0,v=c.transferSize;v&&v>1e3*o.fileSize?d="IMAGE_SIZE_EXCEED":g&&g>o.duration&&(d="IMAGE_DURATION_EXCEED"),d&&(f=!0,this.errManager._pushResource({category:a.RESOURCE,sec_category:d,content:u}))}}f||this.push({type:l,connectType:this.getConnectTypeByUrl(u),resourceUrl:p?w(u):u,responsetime:g.toString()||"0",responsebyte:c.transferSize&&c.transferSize.toString()||"0",statusCode:"200|",logContent:p?u:""})}}this.triggerReport()}}},{key:"filterEntries",value:function(e){for(var t=[],r=["link","script","img","css"],n=0;n<e.length;n++){var o=e[n];r.indexOf(o.initiatorType)>-1&&t.push(o)}return t}},{key:"observeResourceTiming",value:function(){var e=this;this.resTimingObserved||(this.resTimingObserved=!0,!this.cfgManager.get(y).disablePerformanceObserver&&v.PerformanceObserver()?new window.PerformanceObserver((function(t){try{var r=t.getEntries();e.parsePerformanceEntries(r)}catch(e){l.reportSysError(e)}})).observe({entryTypes:["resource"]}):p.on("ajaxCall",(function(){setTimeout((function(){var t=e.entryCache,r=window.performance.getEntries();if(r.length!==t.length&&r.length>t.length){for(var n=[],o=0;o<r.length;o++)-1===t.indexOf(r[o].name)&&n.push(r[o]);t=r,e.parsePerformanceEntries(n)}}),1500)})))}},{key:"handleResourceTiming",value:function(){try{if(this.isSupportGetEntries){var e=window.performance.getEntries();this.parsePerformanceEntries(e),this.observeResourceTiming()}}catch(e){l.reportSysWarn(e)}}},{key:"handleResourceLoadError",value:function(e){var t=this,r=e.target||e.srcElement;try{(r instanceof HTMLScriptElement||r instanceof HTMLLinkElement||r instanceof HTMLImageElement)&&function(){var e=r.src||r.href,n=l.getHref();if(e&&n&&0!==n.indexOf(e)){var o=(r.nodeName||"").toLowerCase();if(o){var i="img"===o?w(e):e;if(i&&t.filterResource(i)){c.test(e)&&h._log("[Error]:"+JSON.stringify({type:"js",url:e}),"owl","error",["resourceError"]);var s=l.getXPath(r),u=e+(s?"\n"+s:"");t.isSupportGetEntries?t.pushApi({type:t.parseType(o,e),resourceUrl:i,connectType:t.getConnectTypeByUrl(i),responsetime:"0",statusCode:"500|",firstCategory:a.RESOURCE,secondCategory:o,logContent:u}):t.errManager._pushResource({category:a.RESOURCE,sec_category:o,content:u})}}}}()}catch(e){l.reportSysError(e)}}},{key:"_stringify",value:function(){var e=this.cache;if(e&&e.length){var t=this.cfgManager.getExtension(),r={region:"",operator:"",network:"",container:"",os:"",unionId:""};for(var n in r)r.hasOwnProperty(n)&&(r[n]=t[n]||"");for(var o=[],i=0;i<e.length;i++)o.push(e[i]);return r.infos=o,r}}},{key:"doBatchPush",value:function(e){e=this.parse(e);var t=new i(e),r=!0,n=this.cfgManager.get("onBatchPush");if("function"==typeof n)try{r=n(t)}catch(e){g.ignore(e)}r&&this.cache.push(t)}},{key:"push",value:function(e){Math.random()>this.cfgManager.get(y).sample||(this.doBatchPush(e),this.cache.length>=10?this.report(!0):this.triggerReport())}},{key:"parse",value:function(e){return e.pageUrl=e.pageUrl||this.cfgManager.get("pageUrl"),e.project=e.project||this.cfgManager.get("project"),e.realUrl=e.realUrl||location.href,e}},{key:"pushApi",value:function(e){Math.random()>this.cfgManager.get(y).sampleApi||(this.doBatchPush(e),this.triggerReport())}},{key:"report",value:function(){this.triggerReport(!0)}},{key:"triggerReport",value:function(e){var t=this;if(this.cache.length){var r=this.cfgManager.get(y).delay;e?this.send():this.comboTimeout||-1===r||(this.comboTimeout=setTimeout((function(){clearTimeout(t.comboTimeout),t.comboTimeout=0,t.send()}),r))}}},{key:"send",value:function(){var e=this._stringify();if(e){var t=this.cfgManager.getApiPath(y);o({type:"POST",url:t+"&pageId="+this.cfgManager.get("pageId"),data:JSON.stringify(e)}),this.cache=[]}}},{key:"getConnectTypeByUrl",value:function(e){return 0===e.indexOf("https")?"https":0===e.indexOf("http")?"http":0===d.indexOf("https")?"https":"http"}}]),e}();e.exports=S},e=>{"use strict";var t=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();var r=["resourceUrl","connectType","type","timestamp","requestbyte","responsebyte","responsetime","project","pageUrl","realUrl","statusCode","firstCategory","secondCategory","logContent","traceid"],n=r,o=function(){function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),r.forEach((function(e){n[e]=t[e]})),this.parse()}return t(e,[{key:"parse",value:function(){this.timestamp=this.timestamp||Date.now().toString(),this.requestbyte=this.requestbyte||"0",this.responsebyte=this.responsebyte||"0"}},{key:"update",value:function(e){for(var t in e)e.hasOwnProperty(t)&&r.indexOf(t)>-1&&(this[t]=e[t])}},{key:"stringify",value:function(){var e=this;return n.map((function(t){return e[t]})).join("\t")}}]),e}();e.exports=o},(e,t,r)=>{"use strict";var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();var o=r(12),i=r(19),a=r(13),s=r(14),c="metric",u=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.cfgManager=t,this.tags={},this.kvs={},this.extraData=""}return n(e,[{key:"setTags",value:function(e){this.tags=o(this.tags,e)}},{key:"getTags",value:function(e){return e?this.tags[e]:this.tags}},{key:"setMetric",value:function(e,t){var r=this;if("string"!=typeof e)return a.log("metric名称必须是string类型");if("number"!=typeof t)return a.log("metric值必须是number类型,当前为"+e+"-"+t);this.kvs[e]||(this.kvs[e]=[]),this.kvs[e].push(t);try{this.cfgManager.get(c).combo&&(this.timeout&&(clearTimeout(this.timeout),this.timeout=null),this.timeout=setTimeout((function(){r.report()}),this.cfgManager.get(c).delay||1500))}catch(e){}}},{key:"setExtraData",value:function(e){this.extraData=e||""}},{key:"getMetric",value:function(e){return e?this.kvs[e]:this.kvs}},{key:"clearMetric",value:function(){this.kvs={}}},{key:"_rollbackMetric",value:function(e){if(e)for(var t in e)e.hasOwnProperty(t)&&(this.kvs[t]=e[t].concat(this.kvs[t]||[]))}},{key:"report",value:function(){var e=this;if(this.kvs&&0!==Object.keys(this.kvs).length){var t={kvs:this.kvs,tags:this.tags,ts:parseInt(+new Date/1e3),extraData:this.extraData},r=this.kvs;this.clearMetric();var n=this.cfgManager,o=s.stringify(n.getApiPath(c),{p:n.get("project"),pageId:n.get("pageId"),unionId:n.getExtension("unionId")});i({url:o,type:"POST",header:{"Content-Type":"application/x-www-form-urlencoded"},data:"data="+encodeURIComponent(JSON.stringify(t)),fail:function(){e._rollbackMetric(r)}})}}}]),e}();e.exports=u},(e,t,r)=>{"use strict";var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();var o=r(19),i=r(14),a=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.cfgManager=t}return n(e,[{key:"report",value:function(e){e=e||{};var t=this.cfgManager,r=t.getExtension(),n=i.stringify(t.getApiPath("pv"),{project:e.project||t.get("project"),pageurl:encodeURIComponent(e.pageUrl||t.get("pageUrl")),pageId:e.pageId||t.get("pageId"),timestamp:Date.now(),region:r.region||"",operator:r.operator||"",network:r.network||"",container:r.container||"",os:r.os||"",unionid:r.unionId||""});o({url:n,type:"POST",header:{"Content-Type":"application/x-www-form-urlencoded"}})}}]),e}();e.exports=a},(e,t,r)=>{"use strict";var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();var o=r(33),i=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.cfgManager=t}return n(e,[{key:"addLog",value:function(e){o.log("[Log]: "+e,{noType:!0})}}]),e}();e.exports=i},(e,t,r)=>{"use strict";var n=r(20),o=r(46);e.exports={getExt:function(){var e={};try{var t=o("network");if(!t){var r=n.getUserAgent(),i=/NetType\/([a-zA-Z0-9]+)/;r&&i.test(r)&&(t=r.match(i)[1])}t=t||n.getConnectionType();var a=o("uuid")||o("unionid")||o("dpid")||o("_lxsdk_cuid");t&&(e.network=t),a&&(e.unionId=a)}catch(e){}return e}}},e=>{"use strict";e.exports=function(e){for(var t=e+"=",r=document.cookie.split(";"),n=0;n<r.length;n++){for(var o=r[n];" "==o.charAt(0);)o=o.substring(1,o.length);if(0===o.indexOf(t))return o.substring(t.length,o.length)}return null}},(e,t,r)=>{"use strict";var n=r(48),o=r(20);e.exports=function(e){if(!e.get("devMode")){e.addFilter("base",n.base);var t=o.getUserAgent();/MicroMessenger/.test(t)?e.addFilter("weixin",n.weixin):/dp\/com\.dianping/.test(t)&&e.addFilter("dianping",n.dianping)}}},e=>{"use strict";e.exports={base:function(e){return!e.resourceUrl||/\.(dpfile|dianping|51ping|meituan|sankuai)\.(com|net)/.test(e.resourceUrl)},weixin:function(e){return!/(WeixinJSBridge|_WXJS|WebViewJavascriptBridge)/.test(e.sec_category)},dianping:function(e){return!/document.elementFromPoint/.test(e.sec_category)}}},e=>{"use strict";e.exports=function(e){var t=e.cfgManager,r=t.get("autoCatch").page,n=t.get("page");if(r&&n.sensoryIndex)e.sensoryObserver();else try{window._Owl_&&window._Owl_.observer&&window._Owl_.observer.disconnect&&window._Owl_.observer.disconnect()}catch(e){}r&&!e.getReady()&&(e.setInitConfig(),document&&"complete"===document.readyState?e.parsePageTimeWithDefer():(window.addEventListener||window.attachEvent)(window.addEventListener?"load":"onload",(function(){e.parsePageTimeWithDefer()})))}},e=>{"use strict";e.exports=function(e){var t=e.cfgManager.get("autoCatch");if(t.js){var r=window.onerror;window.onerror=function(){e.parseWindowError.apply(e,arguments),r&&r.apply(window,arguments)},(window.addEventListener||window.attachEvent)("unhandledrejection",(function(){e.parsePromiseUnhandled.apply(e,arguments)}))}if(t.console&&window.console&&window.console.error){var n=window.console.error;window.console.error=function(){e.parseConsoleError.apply(e,arguments),n&&n.apply(window.console,arguments)}}}},(e,t,r)=>{"use strict";var n=r(21),o=r(52),i=r(53);e.exports=function(e){var t=e.cfgManager,r=t.get("autoCatch"),a=t.get("enableLogTrace")||!1,s=t.get("project"),c=t.get("resource");if(r.ajax&&(o(a,s,c.catchAbort,c.catchTimeout),n.on("ajaxCall",(function(){e.parseAjax.apply(e,arguments)}))),r.fetch&&(i(a,s),n.on("fetchCall",(function(){e.parseFetch.apply(e,arguments)}))),r.resource){var u=window.addEventListener||window.attachEvent,f=window.addEventListener?"load":"onload",l=window.addEventListener?"error":"onerror";document&&"complete"===document.readyState?e.handleResourceTiming.apply(e):u(f,(function(){e.handleResourceTiming.apply(e)})),u(l,(function(t){t&&e.handleResourceLoadError.apply(e,arguments)}),!0)}}},(e,t,r)=>{"use strict";var n=r(20),o=r(21),i=window.XMLHttpRequest;e.exports=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(i&&!i._owl&&(i._owl=!0,!window.location||"file:"!==window.location.protocol))try{var s=i.prototype.open,c=i.prototype.send,u=n.getOrigin();i.prototype.open=function(r,o){this._startTime=+new Date,this.method=r,this.url=o,s&&s.apply(this,arguments);try{if(e&&t&&n.checkSameOrigin(o,u)&&"function"==typeof this.setRequestHeader){var i=n.traceid();i&&(this.setRequestHeader("M-TRACEID",i),this.setRequestHeader("M-APPKEY","fe_"+t),this.traceid=i)}}catch(e){n.reportSysError(e)}},i.prototype.send=function(){var e=this,t=arguments,n="addEventListener",i="onreadystatechange",s=function(t){if(t)if(/catfront.(dianping|51ping).com/.test(e.url))try{var r=void 0;-1!==e.getAllResponseHeaders("content-type").indexOf("application/json")&&(r=JSON.parse(t.currentTarget.response)),200===t.currentTarget.status?e.success&&e.success(r):e.fail&&e.fail(r)}catch(e){}else t.duration=+new Date-e._startTime,o.trigger("ajaxCall",t)};if(n in this)this[n]("load",s),this[n]("error",s),r&&this[n]("abort",s),a&&this[n]("timeout",s);else{var u=this[i];this[i]=function(r){4===e.readyState&&s(r),u&&u.apply(e,t)}}return c&&c.apply(this,arguments)}}catch(e){n.reportSysError(e)}}},(e,t,r)=>{"use strict";var n=r(21),o=r(20);e.exports=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if("function"==typeof window.fetch&&!window.fetch._owl&&"file:"!==(window.location&&window.location.protocol)){var r=window.fetch;window.fetch=function(i){var a=Array.prototype.slice.call(arguments,0),s=(i&&"string"!=typeof i?i.url:i)||"",c=a[1]||{},u=o.getOrigin();if("HEAD"===c.method||"no-cors"===c.mode)return r.apply(window,a);var f=void 0;try{e&&o.checkSameOrigin(s,u)&&t&&(f=o.traceid(),c.headers=new Headers(c.headers),c.headers.append("M-TRACEID",f),c.headers.append("M-APPKEY","fe_"+t),a[1]=c)}catch(e){o.reportSysError(e)}var l=+new Date;return r&&r.apply(window,a).then((function(e){try{if(!e||"function"!=typeof e.clone)return e;var t=e.clone(),r=t.headers,i="";if(r&&"function"==typeof r.get){var a=r.get("content-type");if(a&&!/(text)|(json)/.test(a))return e;i=r.get("x-forbid-reason")||""}return t.text().then((function(e){n.trigger("fetchCall",{url:s,duration:+new Date-l,isSuccess:!0,ok:t.ok,response:e,statusCode:t.status,statusText:t.statusText,xForbidReason:i,traceid:f})})),e}catch(t){return o.reportSysError(t),e}})).catch((function(e){throw n.trigger("fetchCall",{url:s,duration:+new Date-l,isSuccess:!1,errName:e.name,errMsg:e.stack||e.message,traceid:f}),e}))},window.fetch._owl=!0}}},(e,t,r)=>{"use strict";var n=r(19),o=r(14),i=r(16).version,a=r(13);e.exports=function(e,t){if(e&&t&&!(Math.random()>.01)){if(!function(e,t){try{e=e.split(".").map((function(e){return parseInt(e)})),t=t.split(".").map((function(e){return parseInt(e)}));return(e[0]!==t[0]?e[0]-t[0]:e[1]!==t[1]?e[1]-t[1]:e[2]-t[2])>=0}catch(e){return a.ignore(e),!1}}(t.cfgManager.get("version"),i)){var r={v:1,rate:.01,project:e,version:"v_"+i,pageurl:encodeURIComponent(window.location.href),count:1},s=t.cfgManager.url+"/api/version";s=o.stringify(s,r),setTimeout((function(){n({type:"GET",url:s})}),1500)}}}},(e,t,r)=>{"use strict";r.r(t),r.d(t,{initInfo:()=>i});var n=r(56);class o{constructor(){this.info={},this.supportInfo={}}setSupportInfo(e,t){this.supportInfo[e]={...this.supportInfo[e]||{},...t}}setInfo(e){for(const[t,r]of Object.entries(e))this.info[t]=r}getInfo(e){return this.info[e]}getFinInfo(){const e=o.Inst;e.$plugins.forEach((e=>{e.filter&&"function"==typeof e.filter&&(this.supportInfo[e.name]=e.filter(this.supportInfo[e.name]))}));const t={...this.info,...this.supportInfo},{filter:r}=e.$options;return r&&"function"==typeof r?r(t):t}}function i(e){e.$info||(e.$info=new o,o.Inst=e,e.$info.setInfo((0,n.getDeviceInfo)()))}},(e,t,r)=>{"use strict";function n(){return{os:o(),onLine:navigator.onLine,timeStamp:(new Date).getTime(),...i()}}function o(){let e=navigator.userAgent;return/Android/i.test(e)?"Android":/iPhone|iPad|iPod/i.test(e)?"IOS":navigator.platform}function i(){let e=navigator.userAgent.toLocaleLowerCase(),t="",r=null;return null!=e.match(/msie/)||null!=e.match(/trident/)?(r="IE",t=/msie\s(\d+\.\d+)/i.exec(e)[1]):null!=e.match(/firefox/)?(r="firefox",t=/firefox\/(\d+\.\d+)/i.exec(e)[1]):null!=e.match(/ucbrowser/)?(t=/ucbrowser\/(\d+\.\d+)/i.exec(e)[1],r="UC"):null!=e.match(/opera/)||null!=e.match(/opr/)?(t=/opera\/(\d+\.\d+)/i.exec(e)[1],r="opera"):null!=e.match(/metasr/)?(t=/metasr\/(\d+\.\d+)/i.exec(e)[1],r="sougou"):null!=e.match(/tencenttraveler/)||null!=e.match(/qqbrowse/)?(t=/tencenttraveler\/(\d+\.\d+)/i.exec(e)[1]||/qqbrowse\/(\d+\.\d+)/i.exec(e)[1],r="QQ"):null!=e.match(/chrome/)?(r="chrome",t=/chrome\/(\d+\.\d+)/i.exec(e)[1]):null!=e.match(/safari/)?(t=/safari\/(\d+\.\d+)/i.exec(e)[1],r="Safari"):r="others",{browserType:r,browserVersion:t}}r.r(t),r.d(t,{getDeviceInfo:()=>n})},(e,t,r)=>{"use strict";r.r(t),r.d(t,{initPlugin:()=>a});var n=r(58),o=r(59),i=r(6);function a(e){const{plugins:t=[],api:r=[]}=e.$options;0!==t.length&&t.forEach((e=>{e.name||(0,i.handlerError)(i.PLUGIN_NEED_NAME),e.type||(e.type="js")})),e.$plugins=r.map((e=>{!function(e){!function(e){!function(e){e.extra={},e.setExtraData=function(e){Object.entries(e).forEach((([e,t])=>{this.extra[e]=t}))}.bind(e)}(e)}(e);const{type:t}=e;switch(t){case"js":break;case"css":(0,n.cssPluginOptionsExtra)(e);break;case"html":(0,o.htmlPluginOptionsExtra)(e)}}(e);let r=t.find((t=>t.name==e.name));if(r)return{...e,...r};const i=function(e){switch(e.type){case"js":return function(){return Boolean(window[e.name])};case"css":return(0,n.defaultCssPlugin)(e);case"html":return(0,o.defaultHtmlPlugin)(e)}}(e);return{...e,test:i}}))}},(e,t,r)=>{"use strict";function n(e){let{name:t,values:r,expression:n}=e;return function(){return r.every((e=>function(e,r){if(CSS&&CSS.supports)return n?CSS.supports(t):CSS.supports(e,r);let o=document.createElement("div");return o.style[e]=r,window.getComputedStyle(o)[e]===r}(t,e)))}}function o(e){let t=e.value||[];const{name:r}=e;let n,o;-1!=r.indexOf(":")?([n,o]=r.split(":"),";"==o[o.length-1]&&(o=o.slice(-2)),t.push(o)):n=r,e.values=t,e.name=n,e.expression=e.expression||!1}r.r(t),r.d(t,{cssPluginOptionsExtra:()=>o,defaultCssPlugin:()=>n})},(e,t,r)=>{"use strict";function n(e){const{name:t,tags:r}=e;return function(){return r.every((e=>{const r=document.createElement(e);return t in r}))}}function o(e){if(e.tags){if("string"==typeof e.tags&&(e.tags=[e.tags]),!Array.isArray(e.tags))throw TypeError("tags is an array")}else e.tags=["div"]}r.r(t),r.d(t,{defaultHtmlPlugin:()=>n,htmlPluginOptionsExtra:()=>o})},(e,t,r)=>{"use strict";function n(e){return new Promise(((t,r)=>{const{$plugins:n,$info:o}=e,i=[];n.forEach((t=>{t.async?i.push(t):o.setSupportInfo(t.name,function(e,t){return{support:e.test.call(e,t),...e.extra}}(t,e))})),0!==i.length?Promise.all(i.map((t=>t.test.call(t,e)))).then((e=>{i.forEach(((t,r)=>{o.setSupportInfo(t.name,{support:e[r],...t.extra})})),t(!0)})):t(!0)}))}r.r(t),r.d(t,{collectApiSupportInfo:()=>n})}],t={};function r(n){var o=t[n];if(void 0!==o)return o.exports;var i=t[n]={exports:{}};return e[n](i,i.exports,r),i.exports}return r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r(0)})()));
//# sourceMappingURL=ApiSupport.min.js.map